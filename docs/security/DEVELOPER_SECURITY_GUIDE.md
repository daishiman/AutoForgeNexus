# é–‹ç™ºè€…å‘ã‘ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚¬ã‚¤ãƒ‰

**å¯¾è±¡**: AutoForgeNexusé–‹ç™ºãƒãƒ¼ãƒ å…¨å“¡ **æœ€çµ‚æ›´æ–°**: 2025å¹´10æœˆ8æ—¥
**ãƒãƒ¼ã‚¸ãƒ§ãƒ³**: 1.0 **å¿…èª­**: âœ… å¿…é ˆ

---

## ğŸ¯ ã“ã®ã‚¬ã‚¤ãƒ‰ã®ç›®çš„

ã“ã®ã‚¬ã‚¤ãƒ‰ã¯ã€AutoForgeNexusãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã«ãŠã‘ã‚‹ã‚»ã‚­ãƒ¥ã‚¢ãªé–‹ç™ºå®Ÿè·µã‚’æ¨™æº–åŒ–ã—ã€ç§˜å¯†æƒ…å ±æ¼æ´©ã€è„†å¼±æ€§æ··å…¥ã€ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚¤ãƒ³ã‚·ãƒ‡ãƒ³ãƒˆã‚’é˜²æ­¢ã™ã‚‹ã“ã¨ã‚’ç›®çš„ã¨ã—ã¦ã„ã¾ã™ã€‚

**é‡è¦ãªå‰æ**:

- ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã¯**å…¨å“¡ã®è²¬ä»»**ã§ã™
- **äºˆé˜²**ã¯ä¿®æ­£ã‚ˆã‚Šã‚‚100å€åŠ¹ç‡çš„ã§ã™
- ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£å•é¡Œã‚’ç™ºè¦‹ã—ãŸã‚‰**å³åº§ã«å ±å‘Š**ã—ã¦ãã ã•ã„

---

## ğŸ“š ç›®æ¬¡

1. [ç§˜å¯†æƒ…å ±ç®¡ç†](#1-ç§˜å¯†æƒ…å ±ç®¡ç†)
2. [Gitæ“ä½œã®ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹](#2-gitæ“ä½œã®ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹)
3. [ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°è¦ç´„](#3-ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°è¦ç´„)
4. [ä¾å­˜é–¢ä¿‚ç®¡ç†](#4-ä¾å­˜é–¢ä¿‚ç®¡ç†)
5. [ãƒ†ã‚¹ãƒˆã¨CI/CD](#5-ãƒ†ã‚¹ãƒˆã¨cicd)
6. [ã‚¤ãƒ³ã‚·ãƒ‡ãƒ³ãƒˆå¯¾å¿œ](#6-ã‚¤ãƒ³ã‚·ãƒ‡ãƒ³ãƒˆå¯¾å¿œ)
7. [ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ](#7-ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ)

---

## 1. ç§˜å¯†æƒ…å ±ç®¡ç†

### 1.1 ç§˜å¯†æƒ…å ±ã®å®šç¾©

ä»¥ä¸‹ã¯**çµ¶å¯¾ã«Gitã«ã‚³ãƒŸãƒƒãƒˆã—ã¦ã¯ã„ã‘ãªã„**æƒ…å ±ã§ã™ï¼š

#### ğŸ”´ é«˜ãƒªã‚¹ã‚¯ï¼ˆå³åº§ã«ç„¡åŠ¹åŒ–ãŒå¿…è¦ï¼‰

- API ã‚­ãƒ¼ï¼ˆOpenAI, Anthropic, Google AI, Mistral, Cohereç­‰ï¼‰
- ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹èªè¨¼æƒ…å ±ï¼ˆTurso Auth Tokenã€Redis Passwordï¼‰
- OAuth ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‚·ãƒ¼ã‚¯ãƒ¬ãƒƒãƒˆ
- JWT ã‚·ãƒ¼ã‚¯ãƒ¬ãƒƒãƒˆã‚­ãƒ¼
- Cloudflare API Token
- SSH ç§˜å¯†éµã€GPGç§˜å¯†éµ

#### ğŸŸ¡ ä¸­ãƒªã‚¹ã‚¯ï¼ˆæ…é‡ãªç®¡ç†ãŒå¿…è¦ï¼‰

- Discord/Slack Webhook URL
- ã‚»ãƒƒã‚·ãƒ§ãƒ³ã‚·ãƒ¼ã‚¯ãƒ¬ãƒƒãƒˆ
- æš—å·åŒ–ã‚­ãƒ¼
- å†…éƒ¨API ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ

#### ğŸŸ¢ ä½ãƒªã‚¹ã‚¯ï¼ˆå…¬é–‹å¯èƒ½ã ãŒæ³¨æ„ï¼‰

- é–‹ç™ºç’°å¢ƒã®ãƒ€ãƒŸãƒ¼å€¤
- `.env.example`ã®ãƒ—ãƒ¬ãƒ¼ã‚¹ãƒ›ãƒ«ãƒ€ãƒ¼
- å…¬é–‹APIã®ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ

### 1.2 ç§˜å¯†æƒ…å ±ã®ä¿å­˜å ´æ‰€

#### âœ… æ­£ã—ã„ä¿å­˜å ´æ‰€

| ç’°å¢ƒ             | ä¿å­˜å ´æ‰€                               | ä¾‹                                                 |
| ---------------- | -------------------------------------- | -------------------------------------------------- |
| **ãƒ­ãƒ¼ã‚«ãƒ«é–‹ç™º** | `.env`, `.env.local`ï¼ˆ.gitignoreå¯¾è±¡ï¼‰ | `OPENAI_API_KEY=sk-proj-xxx`                       |
| **CI/CD**        | GitHub Secrets                         | `${{ secrets.OPENAI_API_KEY }}`                    |
| **æœ¬ç•ªç’°å¢ƒ**     | Cloudflare Workersç’°å¢ƒå¤‰æ•°             | `wrangler secret put OPENAI_API_KEY`               |
| **ã‚¹ãƒ†ãƒ¼ã‚¸ãƒ³ã‚°** | Cloudflare Workersç’°å¢ƒå¤‰æ•°             | `wrangler secret put --env staging OPENAI_API_KEY` |

#### âŒ é–“é•ã£ãŸä¿å­˜å ´æ‰€

- ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰å†…ã«ãƒãƒ¼ãƒ‰ã‚³ãƒ¼ãƒ‰
- ã‚³ãƒŸãƒƒãƒˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸
- PRèª¬æ˜æ–‡
- GitHub Issues
- Slack/Discord ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸
- `.env.production`ï¼ˆã‚³ãƒŸãƒƒãƒˆå¯¾è±¡ï¼‰

### 1.3 .envãƒ•ã‚¡ã‚¤ãƒ«ã®æ­£ã—ã„ä½¿ã„æ–¹

#### ãƒ•ã‚¡ã‚¤ãƒ«æ§‹æˆ

```bash
AutoForgeNexus/
â”œâ”€â”€ .env                    # ãƒ­ãƒ¼ã‚«ãƒ«é–‹ç™ºç”¨ï¼ˆ.gitignoreå¯¾è±¡ï¼‰
â”œâ”€â”€ .env.example            # ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆï¼ˆã‚³ãƒŸãƒƒãƒˆå¯¾è±¡ï¼‰
â””â”€â”€ backend/
    â”œâ”€â”€ .env.local          # ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰å›ºæœ‰è¨­å®šï¼ˆ.gitignoreå¯¾è±¡ï¼‰
    â””â”€â”€ .env.example        # ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆï¼ˆã‚³ãƒŸãƒƒãƒˆå¯¾è±¡ï¼‰
```

#### .env.example ã®æ›¸ãæ–¹

```bash
# âœ… æ­£ã—ã„ä¾‹
OPENAI_API_KEY=sk-proj-your-openai-api-key-here
ANTHROPIC_API_KEY=sk-ant-your-anthropic-api-key-here
DATABASE_URL=libsql://your-database-name.turso.io

# âŒ é–“é•ã£ãŸä¾‹ï¼ˆå®Ÿéš›ã®å€¤ã‚’è¨˜è¼‰ï¼‰
OPENAI_API_KEY=sk-proj-AbCdEf123456789
ANTHROPIC_API_KEY=sk-ant-RealSecretKey
```

#### .env ãƒ•ã‚¡ã‚¤ãƒ«ã®ä½œæˆæ‰‹é †

```bash
# 1. ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒ«ãƒ¼ãƒˆã§ .env.example ã‚’ã‚³ãƒ”ãƒ¼
cd /path/to/AutoForgeNexus
cp .env.example .env

# 2. å®Ÿéš›ã®ç§˜å¯†æƒ…å ±ã‚’è¨­å®š
nano .env  # ã¾ãŸã¯ vim, vscodeç­‰

# 3. çµ¶å¯¾ã«ã‚³ãƒŸãƒƒãƒˆã—ãªã„
git status  # .env ãŒ Untracked ã§ã‚ã‚‹ã“ã¨ã‚’ç¢ºèª
```

### 1.4 GitHub Secrets ã®ä½¿ã„æ–¹

#### Secrets ã®ç™»éŒ²

```bash
# GitHub CLIçµŒç”±ï¼ˆæ¨å¥¨ï¼‰
gh secret set OPENAI_API_KEY --repo daishiman/AutoForgeNexus

# ã¾ãŸã¯Web UI
# Settings â†’ Secrets and variables â†’ Actions â†’ New repository secret
```

#### Secrets ã®ä½¿ç”¨

```yaml
# .github/workflows/test.yml
name: Test

env:
  OPENAI_API_KEY: ${{ secrets.OPENAI_API_KEY }} # âœ… æ­£ã—ã„
  # OPENAI_API_KEY: sk-proj-xxx  # âŒ é–“é•ã„

jobs:
  test:
    runs-on: ubuntu-latest
    steps:
      - name: Run Tests
        run: pytest tests/
        env:
          ANTHROPIC_API_KEY: ${{ secrets.ANTHROPIC_API_KEY }}
```

### 1.5 ç§˜å¯†æƒ…å ±ã®æ¤œè¨¼

#### pre-commit ãƒ•ãƒƒã‚¯ã®ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—

```bash
# åˆå›ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ï¼ˆå…¨é–‹ç™ºè€…å¿…é ˆï¼‰
cd /path/to/AutoForgeNexus
./scripts/security/setup-pre-commit.sh

# ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ç¢ºèª
pre-commit run --all-files
```

#### æ‰‹å‹•ã‚¹ã‚­ãƒ£ãƒ³

```bash
# TruffleHog ã§Gitå±¥æ­´ã‚¹ã‚­ãƒ£ãƒ³
trufflehog git file://. --only-verified

# Gitleaks ã§ã‚¹ã‚­ãƒ£ãƒ³
gitleaks detect --source . --verbose

# ãƒ•ã‚¡ã‚¤ãƒ«ã‚·ã‚¹ãƒ†ãƒ ã‚¹ã‚­ãƒ£ãƒ³
trufflehog filesystem . --only-verified
```

### 1.6 ç§˜å¯†æƒ…å ±ãŒæ¼æ´©ã—ãŸå ´åˆã®å¯¾å¿œ

#### ğŸš¨ å³åº§ã«å®Ÿè¡Œï¼ˆ5åˆ†ä»¥å†…ï¼‰

1. **ç§˜å¯†æƒ…å ±ã‚’ç„¡åŠ¹åŒ–**

   ```bash
   # ä¾‹: Cloudflare API Tokenå‰Šé™¤
   # Cloudflare Dashboard â†’ My Profile â†’ API Tokens â†’ Delete

   # ä¾‹: Discord Webhookå‰Šé™¤
   # Discord Server â†’ Settings â†’ Integrations â†’ Webhooks â†’ Delete
   ```

2. **ã‚¤ãƒ³ã‚·ãƒ‡ãƒ³ãƒˆå ±å‘Š**
   ```bash
   # GitHub Issueä½œæˆ
   gh issue create --title "ğŸš¨ Security Incident: Secret Leaked" \
     --body "æ¤œå‡ºã•ã‚ŒãŸç§˜å¯†æƒ…å ±: [ç¨®é¡]" \
     --label "security,incident"
   ```

#### ğŸ”§ å¾©æ—§ä½œæ¥­ï¼ˆ1æ™‚é–“ä»¥å†…ï¼‰

3. **æ–°ã—ã„ç§˜å¯†æƒ…å ±ã‚’ç”Ÿæˆ**
4. **GitHub Secretsæ›´æ–°**

   ```bash
   gh secret set OPENAI_API_KEY --repo daishiman/AutoForgeNexus
   ```

5. **ãƒ­ãƒ¼ã‚«ãƒ«ç’°å¢ƒæ›´æ–°**
   ```bash
   nano .env  # æ–°ã—ã„ç§˜å¯†æƒ…å ±ã«æ›´æ–°
   ```

#### ğŸ“‹ äº‹å¾Œå¯¾å¿œï¼ˆ24æ™‚é–“ä»¥å†…ï¼‰

6. **Gitå±¥æ­´ã‹ã‚‰å‰Šé™¤ï¼ˆå¿…è¦ãªå ´åˆã®ã¿ï¼‰**

   ```bash
   # BFG Repo-Cleanerã‚’ä½¿ç”¨ï¼ˆæ¨å¥¨ï¼‰
   brew install bfg
   bfg --delete-files .env
   git reflog expire --expire=now --all
   git gc --prune=now --aggressive

   # Force pushï¼ˆãƒãƒ¼ãƒ å…¨å“¡ã«é€šçŸ¥ãŒå¿…è¦ï¼‰
   git push --force --all
   ```

7. **ã‚¤ãƒ³ã‚·ãƒ‡ãƒ³ãƒˆå ±å‘Šæ›¸ä½œæˆ**
   - ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ: `docs/security/INCIDENT_RESPONSE_REPORT_TEMPLATE.md`

---

## 2. Gitæ“ä½œã®ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹

### 2.1 ã‚³ãƒŸãƒƒãƒˆå‰ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ

#### å¿…é ˆç¢ºèªäº‹é …

```bash
# âœ… ã‚¹ãƒ†ãƒƒãƒ—1: ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ç¢ºèª
git status

# âœ… ã‚¹ãƒ†ãƒƒãƒ—2: å·®åˆ†ç¢ºèª
git diff
git diff --staged  # ã‚¹ãƒ†ãƒ¼ã‚¸ãƒ³ã‚°æ¸ˆã¿ãƒ•ã‚¡ã‚¤ãƒ«

# âœ… ã‚¹ãƒ†ãƒƒãƒ—3: ç§˜å¯†æƒ…å ±ã‚¹ã‚­ãƒ£ãƒ³ï¼ˆpre-commitè‡ªå‹•å®Ÿè¡Œï¼‰
# pre-commit run --all-files  # æ‰‹å‹•å®Ÿè¡Œã‚‚å¯èƒ½

# âœ… ã‚¹ãƒ†ãƒƒãƒ—4: ã‚³ãƒŸãƒƒãƒˆ
git commit -m "feat(auth): Clerkèªè¨¼çµ±åˆã‚’å®Ÿè£…"

# âœ… ã‚¹ãƒ†ãƒƒãƒ—5: Push
git push origin feature/auth-integration
```

### 2.2 ãƒ–ãƒ©ãƒ³ãƒæˆ¦ç•¥

#### GitFlow ã®ä½¿ç”¨

```bash
# âœ… ãƒ•ã‚£ãƒ¼ãƒãƒ£ãƒ¼ãƒ–ãƒ©ãƒ³ãƒä½œæˆ
git checkout -b feature/prompt-optimization

# âœ… ä¿®æ­£ãƒ–ãƒ©ãƒ³ãƒä½œæˆ
git checkout -b fix/security-vulnerability

# âŒ main/masterãƒ–ãƒ©ãƒ³ãƒã§ç›´æ¥ä½œæ¥­ã—ãªã„
git checkout main
git commit -m "..."  # çµ¶å¯¾ã«NG
```

#### ãƒ–ãƒ©ãƒ³ãƒå‘½åè¦å‰‡

```
feature/[æ©Ÿèƒ½å]     ä¾‹: feature/auth-integration
fix/[ä¿®æ­£å†…å®¹]       ä¾‹: fix/sql-injection
hotfix/[ç·Šæ€¥ä¿®æ­£]    ä¾‹: hotfix/critical-security-patch
refactor/[å¯¾è±¡]      ä¾‹: refactor/domain-model
docs/[å¯¾è±¡]          ä¾‹: docs/security-guide
```

### 2.3 ã‚³ãƒŸãƒƒãƒˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸è¦ç´„

#### Conventional Commits å½¢å¼

```bash
# âœ… æ­£ã—ã„ä¾‹
git commit -m "feat(prompt): AIæ”¯æ´ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆä½œæˆæ©Ÿèƒ½ã‚’è¿½åŠ "
git commit -m "fix(security): SQLã‚¤ãƒ³ã‚¸ã‚§ã‚¯ã‚·ãƒ§ãƒ³è„†å¼±æ€§ã‚’ä¿®æ­£"
git commit -m "docs(security): é–‹ç™ºè€…ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚¬ã‚¤ãƒ‰ã‚’è¿½åŠ "
git commit -m "refactor(domain): DDDæº–æ‹ ã®é›†ç´„æ§‹é€ ã«å†è¨­è¨ˆ"

# âŒ é–“é•ã£ãŸä¾‹
git commit -m "update"
git commit -m "fix bug"
git commit -m "add new feature"
```

#### ã‚³ãƒŸãƒƒãƒˆã‚¿ã‚¤ãƒ—

| ã‚¿ã‚¤ãƒ—     | èª¬æ˜               | ä¾‹                                       |
| ---------- | ------------------ | ---------------------------------------- |
| `feat`     | æ–°æ©Ÿèƒ½             | `feat(api): ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆè©•ä¾¡APIã‚’è¿½åŠ `     |
| `fix`      | ãƒã‚°ä¿®æ­£           | `fix(auth): JWTæ¤œè¨¼ã‚¨ãƒ©ãƒ¼ã‚’ä¿®æ­£`         |
| `docs`     | ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ       | `docs(readme): ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—æ‰‹é †ã‚’æ›´æ–°`   |
| `refactor` | ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°   | `refactor(domain): Entityã‚¯ãƒ©ã‚¹å†è¨­è¨ˆ`   |
| `test`     | ãƒ†ã‚¹ãƒˆè¿½åŠ          | `test(prompt): ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆä½œæˆãƒ†ã‚¹ãƒˆè¿½åŠ ` |
| `chore`    | ãƒ“ãƒ«ãƒ‰ãƒ»è¨­å®š       | `chore(deps): ä¾å­˜é–¢ä¿‚ã‚’æ›´æ–°`            |
| `perf`     | ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æ”¹å–„ | `perf(api): ã‚­ãƒ£ãƒƒã‚·ãƒ¥æˆ¦ç•¥æœ€é©åŒ–`        |
| `ci`       | CI/CD              | `ci(github): TruffleHogã‚¹ã‚­ãƒ£ãƒ³è¿½åŠ `     |
| `security` | ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£       | `security(auth): ãƒ¬ãƒ¼ãƒˆåˆ¶é™ã‚’å®Ÿè£…`       |

---

## 3. ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°è¦ç´„

### 3.1 Python (Backend)

#### ã‚»ã‚­ãƒ¥ã‚¢ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°

```python
# âœ… æ­£ã—ã„ä¾‹: ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿åŒ–ã‚¯ã‚¨ãƒª
from sqlalchemy import select

def get_user_by_email(email: str) -> User:
    query = select(User).where(User.email == email)
    return session.execute(query).scalar_one_or_none()

# âŒ é–“é•ã£ãŸä¾‹: SQLã‚¤ãƒ³ã‚¸ã‚§ã‚¯ã‚·ãƒ§ãƒ³è„†å¼±æ€§
def get_user_by_email(email: str) -> User:
    query = f"SELECT * FROM users WHERE email = '{email}'"  # å±é™ºï¼
    return session.execute(query)
```

#### å…¥åŠ›æ¤œè¨¼

```python
# âœ… æ­£ã—ã„ä¾‹: Pydanticæ¤œè¨¼
from pydantic import BaseModel, EmailStr, Field

class CreateUserRequest(BaseModel):
    email: EmailStr  # ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹å½¢å¼æ¤œè¨¼
    password: str = Field(..., min_length=8, max_length=128)
    username: str = Field(..., regex=r"^[a-zA-Z0-9_-]+$")

# âŒ é–“é•ã£ãŸä¾‹: æ¤œè¨¼ãªã—
def create_user(email: str, password: str, username: str):
    user = User(email=email, password=password, username=username)
    session.add(user)
```

#### ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãƒãƒƒã‚·ãƒ³ã‚°

```python
# âœ… æ­£ã—ã„ä¾‹: Bcryptã§ãƒãƒƒã‚·ãƒ³ã‚°
from passlib.context import CryptContext

pwd_context = CryptContext(schemes=["bcrypt"], deprecated="auto")

def hash_password(password: str) -> str:
    return pwd_context.hash(password)

def verify_password(plain: str, hashed: str) -> bool:
    return pwd_context.verify(plain, hashed)

# âŒ é–“é•ã£ãŸä¾‹: å¹³æ–‡ä¿å­˜
def save_password(password: str):
    user.password = password  # çµ¶å¯¾ã«NGï¼
```

### 3.2 TypeScript (Frontend)

#### XSSå¯¾ç­–

```typescript
// âœ… æ­£ã—ã„ä¾‹: Reactè‡ªå‹•ã‚¨ã‚¹ã‚±ãƒ¼ãƒ—
import React from 'react';

const UserProfile = ({ name }: { name: string }) => {
  return <div>{name}</div>;  // è‡ªå‹•ã‚¨ã‚¹ã‚±ãƒ¼ãƒ—
};

// âŒ é–“é•ã£ãŸä¾‹: dangerouslySetInnerHTML
const UserProfile = ({ html }: { html: string }) => {
  return <div dangerouslySetInnerHTML={{ __html: html }} />;  // å±é™ºï¼
};
```

#### APIå‘¼ã³å‡ºã—ã®ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£

```typescript
// âœ… æ­£ã—ã„ä¾‹: ç’°å¢ƒå¤‰æ•°ã‹ã‚‰APIã‚­ãƒ¼å–å¾—
const apiKey = process.env.NEXT_PUBLIC_API_KEY;

// âŒ é–“é•ã£ãŸä¾‹: ãƒãƒ¼ãƒ‰ã‚³ãƒ¼ãƒ‰
const apiKey = 'sk-proj-AbCdEf123456789'; // çµ¶å¯¾ã«NGï¼
```

### 3.3 OWASP Top 10 å¯¾ç­–

#### A01:2021 â€“ ã‚¢ã‚¯ã‚»ã‚¹åˆ¶å¾¡ã®ä¸å‚™

```python
# âœ… æ­£ã—ã„ä¾‹: æ¨©é™ãƒã‚§ãƒƒã‚¯
from fastapi import Depends, HTTPException

def require_admin(user: User = Depends(get_current_user)):
    if not user.is_admin:
        raise HTTPException(status_code=403, detail="Admin access required")
    return user

@router.delete("/users/{user_id}")
async def delete_user(user_id: int, admin: User = Depends(require_admin)):
    # ç®¡ç†è€…ã®ã¿å®Ÿè¡Œå¯èƒ½
    pass
```

#### A02:2021 â€“ æš—å·åŒ–ã®å¤±æ•—

```python
# âœ… æ­£ã—ã„ä¾‹: æš—å·åŒ–é€šä¿¡
from fastapi import FastAPI

app = FastAPI()

# Cloudflare Pages/Workers ã§ã¯è‡ªå‹•çš„ã«HTTPSå¼·åˆ¶
# ãƒ­ãƒ¼ã‚«ãƒ«é–‹ç™ºã§ã¯mkcertã§HTTPSè¨¼æ˜æ›¸ã‚’ç”Ÿæˆ
```

#### A03:2021 â€“ ã‚¤ãƒ³ã‚¸ã‚§ã‚¯ã‚·ãƒ§ãƒ³

```python
# âœ… æ­£ã—ã„ä¾‹: ORMã¨ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿åŒ–
query = select(Prompt).where(Prompt.user_id == user_id)

# âŒ é–“é•ã£ãŸä¾‹: æ–‡å­—åˆ—çµåˆ
query = f"SELECT * FROM prompts WHERE user_id = {user_id}"
```

---

## 4. ä¾å­˜é–¢ä¿‚ç®¡ç†

### 4.1 ä¾å­˜é–¢ä¿‚ã®è¿½åŠ 

#### Python (backend)

```bash
# âœ… æ­£ã—ã„æ‰‹é †
cd backend

# 1. ä¾å­˜é–¢ä¿‚è¿½åŠ 
poetry add fastapi

# 2. é–‹ç™ºä¾å­˜é–¢ä¿‚è¿½åŠ 
poetry add --group dev pytest

# 3. requirements.txtç”Ÿæˆ
poetry export -f requirements.txt --output requirements.txt --without-hashes

# 4. ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚¹ã‚­ãƒ£ãƒ³
safety check
bandit -r src/
```

#### Node.js (frontend)

```bash
# âœ… æ­£ã—ã„æ‰‹é †
cd frontend

# 1. ä¾å­˜é–¢ä¿‚è¿½åŠ 
pnpm add next@latest

# 2. é–‹ç™ºä¾å­˜é–¢ä¿‚è¿½åŠ 
pnpm add -D @types/node

# 3. ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ç›£æŸ»
pnpm audit
pnpm audit --fix  # è‡ªå‹•ä¿®æ­£
```

### 4.2 è„†å¼±æ€§ã‚¹ã‚­ãƒ£ãƒ³

#### å®šæœŸã‚¹ã‚­ãƒ£ãƒ³ï¼ˆé€±æ¬¡æ¨å¥¨ï¼‰

```bash
# Python
cd backend
safety check --json
pip-audit

# Node.js
cd frontend
pnpm audit
npm audit fix

# Docker
trivy image autoforgenexus-backend:latest
```

### 4.3 ä¾å­˜é–¢ä¿‚æ›´æ–°

```bash
# Python
cd backend
poetry update
poetry show --outdated

# Node.js
cd frontend
pnpm update
pnpm outdated
```

---

## 5. ãƒ†ã‚¹ãƒˆã¨CI/CD

### 5.1 ãƒ†ã‚¹ãƒˆè¦ä»¶

#### ã‚«ãƒãƒ¬ãƒƒã‚¸ç›®æ¨™

| é ˜åŸŸ     | æœ€ä½ã‚«ãƒãƒ¬ãƒƒã‚¸ | æ¨å¥¨ã‚«ãƒãƒ¬ãƒƒã‚¸ |
| -------- | -------------- | -------------- |
| Backend  | 80%            | 90%+           |
| Frontend | 75%            | 85%+           |
| E2E      | 50%            | 70%+           |

#### ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ

```bash
# Backend
cd backend
pytest tests/ --cov=src --cov-report=html --cov-fail-under=80

# Frontend
cd frontend
pnpm test --coverage

# E2E
cd frontend
pnpm test:e2e
```

### 5.2 CI/CD ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£

#### GitHub Actions ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹

```yaml
# âœ… æ­£ã—ã„ä¾‹
name: Security Scan

on:
  pull_request:
  push:
    branches: [main, develop]

permissions:
  contents: read # æœ€å°æ¨©é™
  security-events: write

jobs:
  security:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4

      - name: TruffleHog Scan
        run: |
          docker run --rm -v "$PWD:/workdir" \
            trufflesecurity/trufflehog:latest \
            git file:///workdir --only-verified --fail

      - name: Dependency Scan
        run: |
          pip install safety
          safety check --json
```

---

## 6. ã‚¤ãƒ³ã‚·ãƒ‡ãƒ³ãƒˆå¯¾å¿œ

### 6.1 ã‚¤ãƒ³ã‚·ãƒ‡ãƒ³ãƒˆã®å®šç¾©

| ãƒ¬ãƒ™ãƒ«       | å®šç¾©                             | å¯¾å¿œæ™‚é–“         | ä¾‹                     |
| ------------ | -------------------------------- | ---------------- | ---------------------- |
| **Critical** | æœ¬ç•ªã‚·ã‚¹ãƒ†ãƒ åœæ­¢ã€å¤§è¦æ¨¡æƒ…å ±æ¼æ´© | å³åº§ï¼ˆ15åˆ†ä»¥å†…ï¼‰ | API Keyæ¼æ´©ã€RCEè„†å¼±æ€§ |
| **High**     | éƒ¨åˆ†çš„æ©Ÿèƒ½åœæ­¢ã€ä¸­è¦æ¨¡æƒ…å ±æ¼æ´©   | 1æ™‚é–“ä»¥å†…        | SQLã‚¤ãƒ³ã‚¸ã‚§ã‚¯ã‚·ãƒ§ãƒ³    |
| **Medium**   | ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ä½ä¸‹ã€è»½å¾®ãªæ¼æ´©   | 1æ—¥ä»¥å†…          | è„†å¼±ãªä¾å­˜é–¢ä¿‚         |
| **Low**      | è»½å¾®ãªå•é¡Œã€äºˆé˜²çš„å¯¾å¿œ           | 1é€±é–“ä»¥å†…        | ã‚³ãƒ¼ãƒ‰å“è³ªå•é¡Œ         |

### 6.2 å ±å‘Šæ‰‹é †

#### ç§˜å¯†æƒ…å ±æ¼æ´©ã‚’ç™ºè¦‹ã—ãŸå ´åˆ

```bash
# 1. GitHub Issueä½œæˆ
gh issue create \
  --title "ğŸš¨ [SECURITY] Secret Leaked: [ç¨®é¡]" \
  --body "æ¤œå‡ºå†…å®¹: [è©³ç´°]" \
  --label "security,incident,P0" \
  --assignee security-architect

# 2. Discordã§å³åº§ã«é€šçŸ¥
# (Webhook URL: CI/CDçµŒç”±ã§é€šçŸ¥ã•ã‚Œã‚‹)

# 3. ç§˜å¯†æƒ…å ±ã‚’å³åº§ã«ç„¡åŠ¹åŒ–
# (å„ã‚µãƒ¼ãƒ“ã‚¹ã®ç®¡ç†ç”»é¢ã§å‰Šé™¤/å†ç”Ÿæˆ)
```

### 6.3 ã‚¤ãƒ³ã‚·ãƒ‡ãƒ³ãƒˆå¯¾å¿œãƒ•ãƒ­ãƒ¼

```
æ¤œå‡º
  â†“
åˆ†é¡ï¼ˆCritical/High/Medium/Lowï¼‰
  â†“
[Critical/High] â†’ å³åº§ã«å¯¾å¿œ
  â”œâ”€ ç§˜å¯†æƒ…å ±ç„¡åŠ¹åŒ–
  â”œâ”€ ã‚¤ãƒ³ã‚·ãƒ‡ãƒ³ãƒˆå ±å‘Š
  â”œâ”€ å¾©æ—§ä½œæ¥­
  â””â”€ äº‹å¾Œãƒ¬ãƒãƒ¼ãƒˆä½œæˆ
  â†“
[Medium/Low] â†’ è¨ˆç”»çš„å¯¾å¿œ
  â”œâ”€ Issueç™»éŒ²
  â”œâ”€ å„ªå…ˆåº¦è¨­å®š
  â””â”€ ã‚¹ãƒ—ãƒªãƒ³ãƒˆè¨ˆç”»
```

---

## 7. ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ

### 7.1 æ–°è¦é–‹ç™ºè€…ã‚ªãƒ³ãƒœãƒ¼ãƒ‡ã‚£ãƒ³ã‚°

- [ ] ã“ã®ã‚¬ã‚¤ãƒ‰ã‚’æœ€åˆã‹ã‚‰æœ€å¾Œã¾ã§èª­ã‚€
- [ ] pre-commitãƒ•ãƒƒã‚¯ã‚’ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—
  ```bash
  ./scripts/security/setup-pre-commit.sh
  ```
- [ ] .envãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆï¼ˆ.env.exampleã‹ã‚‰ã‚³ãƒ”ãƒ¼ï¼‰
- [ ] GitHub Secretsã¸ã®ã‚¢ã‚¯ã‚»ã‚¹æ¨©é™ã‚’ç¢ºèª
- [ ] ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°ã‚’å—è¬›
- [ ] ç§˜å¯†æƒ…å ±ç®¡ç†ãƒãƒªã‚·ãƒ¼ã«ç½²å

### 7.2 ã‚³ãƒŸãƒƒãƒˆå‰ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ

- [ ] `git status` ã§å¤‰æ›´å†…å®¹ã‚’ç¢ºèª
- [ ] `git diff` ã§å·®åˆ†ã‚’ç¢ºèª
- [ ] ç§˜å¯†æƒ…å ±ãŒå«ã¾ã‚Œã¦ã„ãªã„ã‹ç›®è¦–ç¢ºèª
- [ ] pre-commitãƒ•ãƒƒã‚¯ãŒå®Ÿè¡Œã•ã‚Œã‚‹ã“ã¨ã‚’ç¢ºèª
- [ ] ãƒ†ã‚¹ãƒˆãŒå…¨ã¦ãƒ‘ã‚¹
  ```bash
  pytest tests/  # Backend
  pnpm test      # Frontend
  ```
- [ ] Lintã‚¨ãƒ©ãƒ¼ãŒãªã„
  ```bash
  ruff check src/  # Backend
  pnpm lint        # Frontend
  ```

### 7.3 PRä½œæˆå‰ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ

- [ ] ãƒ–ãƒ©ãƒ³ãƒåãŒå‘½åè¦å‰‡ã«å¾“ã£ã¦ã„ã‚‹
- [ ] ã‚³ãƒŸãƒƒãƒˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒConventional Commitså½¢å¼
- [ ] PRèª¬æ˜æ–‡ã«ãƒ†ã‚¹ãƒˆæ‰‹é †ã‚’è¨˜è¼‰
- [ ] CI/CDãŒå…¨ã¦ãƒ‘ã‚¹
- [ ] ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚¹ã‚­ãƒ£ãƒ³ãŒå…¨ã¦ãƒ‘ã‚¹
- [ ] ã‚«ãƒãƒ¬ãƒƒã‚¸ãŒç›®æ¨™å€¤ä»¥ä¸Š
- [ ] ãƒ¬ãƒ“ãƒ¥ã‚¢ãƒ¼ã‚’2åä»¥ä¸ŠæŒ‡å®š

### 7.4 ãƒ¬ãƒ“ãƒ¥ã‚¢ãƒ¼ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ

- [ ] ã‚³ãƒ¼ãƒ‰ãŒã‚»ã‚­ãƒ¥ã‚¢ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°è¦ç´„ã«æº–æ‹ 
- [ ] å…¥åŠ›æ¤œè¨¼ãŒé©åˆ‡ã«å®Ÿè£…ã•ã‚Œã¦ã„ã‚‹
- [ ] ç§˜å¯†æƒ…å ±ãŒãƒãƒ¼ãƒ‰ã‚³ãƒ¼ãƒ‰ã•ã‚Œã¦ã„ãªã„
- [ ] SQLã‚¤ãƒ³ã‚¸ã‚§ã‚¯ã‚·ãƒ§ãƒ³å¯¾ç­–ãŒå®Ÿè£…ã•ã‚Œã¦ã„ã‚‹
- [ ] XSSå¯¾ç­–ãŒå®Ÿè£…ã•ã‚Œã¦ã„ã‚‹
- [ ] èªè¨¼ãƒ»èªå¯ãŒé©åˆ‡ã«å®Ÿè£…ã•ã‚Œã¦ã„ã‚‹
- [ ] ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ãŒé©åˆ‡
- [ ] ãƒ­ã‚°ã«ç§˜å¯†æƒ…å ±ãŒå‡ºåŠ›ã•ã‚Œã¦ã„ãªã„

---

## ğŸ“š å‚è€ƒè³‡æ–™

### å…¬å¼ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ

- [OWASP Top 10 2021](https://owasp.org/Top10/)
- [OWASP ASVS](https://owasp.org/www-project-application-security-verification-standard/)
- [OWASP Cheat Sheet Series](https://cheatsheetseries.owasp.org/)
- [CWE Top 25](https://cwe.mitre.org/top25/archive/2023/2023_top25_list.html)

### ãƒ„ãƒ¼ãƒ«

- [TruffleHog](https://github.com/trufflesecurity/trufflehog)
- [Gitleaks](https://github.com/gitleaks/gitleaks)
- [Bandit](https://bandit.readthedocs.io/)
- [Safety](https://pyup.io/safety/)
- [Snyk](https://snyk.io/)

### ç¤¾å†…ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ

- [ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚¤ãƒ³ã‚·ãƒ‡ãƒ³ãƒˆå¯¾å¿œãƒ¬ãƒãƒ¼ãƒˆ](./INCIDENT_RESPONSE_REPORT_2025-10-08.md)
- [ç§˜å¯†æƒ…å ±ç®¡ç†ãƒãƒªã‚·ãƒ¼](./SECRET_MANAGEMENT_POLICY.md)ï¼ˆä½œæˆäºˆå®šï¼‰
- [ã‚¤ãƒ³ã‚·ãƒ‡ãƒ³ãƒˆå¯¾å¿œãƒ—ãƒ¬ã‚¤ãƒ–ãƒƒã‚¯](./INCIDENT_RESPONSE_PLAYBOOK.md)ï¼ˆä½œæˆäºˆå®šï¼‰

---

## ğŸ†˜ ã‚µãƒãƒ¼ãƒˆ

### è³ªå•ãƒ»ç›¸è«‡

- **ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£è³ªå•**: security@autoforgenexus.dev
- **GitHub Issue**: `security` ãƒ©ãƒ™ãƒ«ã§ä½œæˆ
- **Discord**: #security ãƒãƒ£ãƒ³ãƒãƒ«

### ç·Šæ€¥é€£çµ¡å…ˆ

- **ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚¤ãƒ³ã‚·ãƒ‡ãƒ³ãƒˆ**: security-incident@autoforgenexus.dev
- **ã‚ªãƒ³ã‚³ãƒ¼ãƒ«**: +81-XX-XXXX-XXXX

---

## âœï¸ ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆç®¡ç†

| é …ç›®         | å€¤                       |
| ------------ | ------------------------ |
| ä½œæˆæ—¥       | 2025å¹´10æœˆ8æ—¥            |
| æœ€çµ‚æ›´æ–°     | 2025å¹´10æœˆ8æ—¥            |
| ãƒãƒ¼ã‚¸ãƒ§ãƒ³   | 1.0                      |
| æ¬¡å›ãƒ¬ãƒ“ãƒ¥ãƒ¼ | 2025å¹´11æœˆ8æ—¥            |
| æ‰¿èªè€…       | security-architect Agent |

---

**ã“ã®ã‚¬ã‚¤ãƒ‰ã¯å…¨é–‹ç™ºè€…å¿…èª­ã§ã™ã€‚ä¸æ˜ç‚¹ãŒã‚ã‚Œã°é æ…®ãªãè³ªå•ã—ã¦ãã ã•ã„ã€‚**

ğŸ¤– Generated with [Claude Code](https://claude.com/claude-code)
