# å¤–éƒ¨ã‚µãƒ¼ãƒ“ã‚¹ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ã‚¬ã‚¤ãƒ‰

AutoForgeNexusã§ä½¿ç”¨ã™ã‚‹å¤–éƒ¨ã‚µãƒ¼ãƒ“ã‚¹ï¼ˆClerkèªè¨¼ã€Tursoãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ç­‰ï¼‰ã®è©³ç´°ãªã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—æ‰‹é †ã‚’èª¬æ˜ã—ã¾ã™ã€‚

---

## ğŸ“‘ ç›®æ¬¡

1. [Clerkèªè¨¼ã‚µãƒ¼ãƒ“ã‚¹ã®ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—](#clerkèªè¨¼ã‚µãƒ¼ãƒ“ã‚¹ã®ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—)
2. [Tursoãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã®ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—](#tursoãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã®ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—)
3. [ç’°å¢ƒå¤‰æ•°ã®çµ±åˆè¨­å®š](#ç’°å¢ƒå¤‰æ•°ã®çµ±åˆè¨­å®š)
4. [æ¥ç¶šç¢ºèªã¨ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°](#æ¥ç¶šç¢ºèªã¨ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°)

---

# ğŸ” Clerkèªè¨¼ã‚µãƒ¼ãƒ“ã‚¹ã®ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—

## å‰ææ¡ä»¶

- GitHubã‚¢ã‚«ã‚¦ãƒ³ãƒˆï¼ˆClerkèªè¨¼ã«ä½¿ç”¨ï¼‰
- ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹

## ã‚¹ãƒ†ãƒƒãƒ—1: Clerkã‚¢ã‚«ã‚¦ãƒ³ãƒˆä½œæˆ

### 1-1. å…¬å¼ã‚µã‚¤ãƒˆã‚¢ã‚¯ã‚»ã‚¹

```
https://clerk.com ã«ã‚¢ã‚¯ã‚»ã‚¹
  â†“
ã€ŒSign upã€ã‚’ã‚¯ãƒªãƒƒã‚¯
  â†“
GitHubé€£æºã§ã‚¢ã‚«ã‚¦ãƒ³ãƒˆä½œæˆï¼ˆæ¨å¥¨ï¼‰
```

### 1-2. ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆä½œæˆ

```
Dashboard â†’ ã€ŒCreate applicationã€
  â†“
Application name: AutoForgeNexus
  â†“
èªè¨¼æ–¹æ³•é¸æŠ:
  âœ“ Email + Passwordï¼ˆæ¨å¥¨ï¼‰
  âœ“ Google OAuthï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼‰
  âœ“ GitHub OAuthï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼‰
```

## ã‚¹ãƒ†ãƒƒãƒ—2: API Keyså–å¾—

### 2-1. Developmentã‚­ãƒ¼å–å¾—

```
Clerk Dashboard
  â†“
å·¦ã‚µã‚¤ãƒ‰ãƒãƒ¼ â†’ ã€ŒAPI Keysã€
  â†“
ã€ŒDevelopmentã€ã‚¿ãƒ–ã‚’é¸æŠ
  â†“
ä»¥ä¸‹ã‚’ã‚³ãƒ”ãƒ¼:
```

**Publishable Keyï¼ˆå…¬é–‹éµï¼‰**:

```
pk_test_xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
```

âš ï¸ ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆå´ã§ä½¿ç”¨å¯èƒ½ï¼ˆãƒ–ãƒ©ã‚¦ã‚¶ã§å…¬é–‹OKï¼‰

**Secret Keyï¼ˆç§˜å¯†éµï¼‰**:

```
sk_test_xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
```

âš ï¸ ã‚µãƒ¼ãƒãƒ¼å´ã®ã¿ã§ä½¿ç”¨ï¼ˆçµ¶å¯¾ã«å…¬é–‹ã—ãªã„ï¼‰

### 2-2. Productionã‚­ãƒ¼å–å¾—

```
Clerk Dashboard ä¸Šéƒ¨
  â†“
ã€ŒDevelopmentã€â†’ã€ŒCreate production instanceã€
  â†“
Production Instanceä½œæˆ
  â†“
ã€ŒAPI Keysã€â†’ã€ŒProductionã€ã‚¿ãƒ–
  â†“
ä»¥ä¸‹ã‚’ã‚³ãƒ”ãƒ¼:
```

**Production Publishable Key**:

```
pk_live_xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
```

**Production Secret Key**:

```
sk_live_xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
```

## ã‚¹ãƒ†ãƒƒãƒ—3: ãƒ‰ãƒ¡ã‚¤ãƒ³è¨­å®šï¼ˆProductionç’°å¢ƒï¼‰

### 3-1. ã‚«ã‚¹ã‚¿ãƒ ãƒ‰ãƒ¡ã‚¤ãƒ³è¨­å®š

```
Production Instance â†’ å·¦ã‚µã‚¤ãƒ‰ãƒãƒ¼ã€ŒDomainsã€
  â†“
ã€ŒChange domainã€ã‚»ã‚¯ã‚·ãƒ§ãƒ³
  â†“
ã‚«ã‚¹ã‚¿ãƒ ãƒ‰ãƒ¡ã‚¤ãƒ³å…¥åŠ›: autoforgenexus.com
```

### 3-2. DNSè¨­å®šï¼ˆ5ã¤ã®å¿…é ˆãƒ¬ã‚³ãƒ¼ãƒ‰ï¼‰

**Cloudflare DNSã®å ´åˆ**:

| ã‚¿ã‚¤ãƒ— | åå‰        | å€¤                                  | Proxy       |
| ------ | ----------- | ----------------------------------- | ----------- |
| CNAME  | clerk       | clerk.shared.lcl.dev                | DNS only âš ï¸ |
| CNAME  | accounts    | accounts-clerk.lcl.dev              | DNS only âš ï¸ |
| CNAME  | \_domainkey | dkim1.\_domainkey.clerk.com         | DNS only    |
| TXT    | \_clerk     | clerk-verification=xxxxx            | -           |
| TXT    | @           | v=spf1 include:\_spf.clerk.com ~all | -           |

âš ï¸ **é‡è¦**: Cloudflareã®å ´åˆã€Proxy statusï¼ˆãƒ—ãƒ­ã‚­ã‚·ï¼‰ã‚’å¿…ãšã€ŒDNS
onlyã€ï¼ˆã‚°ãƒ¬ãƒ¼é›²ãƒãƒ¼ã‚¯ï¼‰ã«è¨­å®šã—ã¦ãã ã•ã„ã€‚

### 3-3. è¨¼æ˜æ›¸ãƒ‡ãƒ—ãƒ­ã‚¤

```
DNSä¼æ’­å®Œäº†å¾Œï¼ˆæœ€å¤§48æ™‚é–“ï¼‰
  â†“
Clerk Dashboard ãƒ›ãƒ¼ãƒ 
  â†“
ã€ŒDeploy certificatesã€ãƒœã‚¿ãƒ³ãŒè¡¨ç¤ºã•ã‚Œã‚‹
  â†“
ã‚¯ãƒªãƒƒã‚¯ã—ã¦SSLè¨¼æ˜æ›¸è‡ªå‹•ç™ºè¡Œ
```

---

# ğŸ—„ï¸ Tursoãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã®ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—

## å‰ææ¡ä»¶

- GitHubã‚¢ã‚«ã‚¦ãƒ³ãƒˆï¼ˆTursoèªè¨¼ã«ä½¿ç”¨ï¼‰
- Turso CLI ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

## ã‚¹ãƒ†ãƒƒãƒ—1: Turso CLIã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

### macOS (Homebrew)

```bash
# Turso CLI ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
brew install tursodatabase/tap/turso

# ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ç¢ºèª
turso --version

# æœŸå¾…ã•ã‚Œã‚‹å‡ºåŠ›: turso version v0.xx.x
```

### ãã®ä»–ã®OS

```bash
# curlçµŒç”±ã§ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
curl -sSfL https://get.tur.so/install.sh | bash

# ãƒ‘ã‚¹ã‚’é€šã™
export PATH="$HOME/.turso:$PATH"
echo 'export PATH="$HOME/.turso:$PATH"' >> ~/.zshrc
source ~/.zshrc
```

## ã‚¹ãƒ†ãƒƒãƒ—2: Tursoã‚¢ã‚«ã‚¦ãƒ³ãƒˆèªè¨¼

```bash
# GitHubçµŒç”±ã§ãƒ­ã‚°ã‚¤ãƒ³ï¼ˆãƒ–ãƒ©ã‚¦ã‚¶ãŒè‡ªå‹•ã§é–‹ãï¼‰
turso auth login

# èªè¨¼æˆåŠŸç¢ºèª
turso auth whoami

# æœŸå¾…ã•ã‚Œã‚‹å‡ºåŠ›:
# Logged in as: your-github-username
```

## ã‚¹ãƒ†ãƒƒãƒ—3: ã‚¹ãƒ†ãƒ¼ã‚¸ãƒ³ã‚°ç’°å¢ƒãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ä½œæˆ

### 3-1. ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ä½œæˆ

```bash
# ã‚¹ãƒ†ãƒ¼ã‚¸ãƒ³ã‚°ç”¨ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ä½œæˆ
turso db create autoforgenexus-staging

# æˆåŠŸãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ä¾‹:
# Created database autoforgenexus-staging at group default in iad (Washington, D.C.)
```

**ã‚ªãƒ—ã‚·ãƒ§ãƒ³: ãƒªãƒ¼ã‚¸ãƒ§ãƒ³æŒ‡å®š**

```bash
# åˆ©ç”¨å¯èƒ½ãªãƒ­ã‚±ãƒ¼ã‚·ãƒ§ãƒ³ç¢ºèª
turso db locations

# æ±äº¬ãƒªãƒ¼ã‚¸ãƒ§ãƒ³æŒ‡å®šï¼ˆä½ãƒ¬ã‚¤ãƒ†ãƒ³ã‚·ãƒ¼ãƒ»æ¨å¥¨ï¼‰
turso db create autoforgenexus-staging --location aws-ap-northeast-1

# ä¸»è¦ãªåˆ©ç”¨å¯èƒ½ãªãƒ­ã‚±ãƒ¼ã‚·ãƒ§ãƒ³ï¼ˆ2025å¹´æœ€æ–°ï¼‰:
# aws-ap-northeast-1  - Tokyo, Japanï¼ˆæ¨å¥¨: æ—¥æœ¬å‘ã‘ï¼‰
# aws-ap-southeast-1  - Singapore
# aws-ap-southeast-2  - Sydney, Australia
# aws-eu-central-1    - Frankfurt, Germany
# aws-eu-west-1       - Dublin, Ireland
# aws-us-east-1       - Virginia, USA
# aws-us-west-2       - Oregon, USA

# ç¾åœ¨ã®ã‚°ãƒ«ãƒ¼ãƒ—æƒ…å ±ç¢ºèª
turso group show default
```

### 3-2. æ¥ç¶šæƒ…å ±å–å¾—

```bash
# ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹URLå–å¾—
turso db show autoforgenexus-staging --url

# å‡ºåŠ›ä¾‹:
# libsql://autoforgenexus-staging-your-org.turso.io
```

**ã“ã®URLã‚’ã‚³ãƒ”ãƒ¼ã—ã¦ä¿å­˜ã—ã¦ãã ã•ã„ï¼**

### 3-3. èªè¨¼ãƒˆãƒ¼ã‚¯ãƒ³ç”Ÿæˆ

```bash
# èªè¨¼ãƒˆãƒ¼ã‚¯ãƒ³ç”Ÿæˆï¼ˆæœ‰åŠ¹æœŸé™ãªã—ï¼‰
turso db tokens create autoforgenexus-staging

# å‡ºåŠ›ä¾‹ï¼ˆã“ã®ãƒˆãƒ¼ã‚¯ãƒ³ã¯äºŒåº¦ã¨è¡¨ç¤ºã•ã‚Œãªã„ã®ã§å¿…ãšä¿å­˜ï¼ï¼‰:
# eyJhbGciOiJFZERTQSIsInR5cCI6IkpXVCJ9.eyJhIjoicnciLCJpYXQiOjE3MzMzMTIwMDAs...
```

âš ï¸
**é‡è¦**: ã“ã®ãƒˆãƒ¼ã‚¯ãƒ³ã‚’ã™ãã«ã‚³ãƒ”ãƒ¼ã—ã¦ã€1Passwordã‚„ã‚»ã‚­ãƒ¥ã‚¢ãªãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãƒãƒãƒ¼ã‚¸ãƒ£ãƒ¼ã«ä¿å­˜ã—ã¦ãã ã•ã„ã€‚äºŒåº¦ã¨è¡¨ç¤ºã•ã‚Œã¾ã›ã‚“ï¼

**ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹: æœ‰åŠ¹æœŸé™ä»˜ããƒˆãƒ¼ã‚¯ãƒ³**

```bash
# 90æ—¥é–“æœ‰åŠ¹ãªãƒˆãƒ¼ã‚¯ãƒ³ç”Ÿæˆï¼ˆæ¨å¥¨ï¼‰
turso db tokens create autoforgenexus-staging --expiration 90d

# ç’°å¢ƒå¤‰æ•°ã«ç›´æ¥è¨­å®š
export TURSO_STAGING_AUTH_TOKEN=$(turso db tokens create autoforgenexus-staging)
```

### 3-4. ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æƒ…å ±ç¢ºèª

```bash
# ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹è©³ç´°è¡¨ç¤º
turso db show autoforgenexus-staging

# å‡ºåŠ›ä¾‹:
# Name:           autoforgenexus-staging
# URL:            libsql://autoforgenexus-staging-your-org.turso.io
# ID:             xxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx
# Group:          default
# Version:        0.24.28
# Locations:      nrt (Tokyo)
# Size:           0 B
```

## ã‚¹ãƒ†ãƒƒãƒ—4: æœ¬ç•ªç’°å¢ƒãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ä½œæˆ

### 4-1. ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ä½œæˆ

```bash
# æœ¬ç•ªç’°å¢ƒç”¨ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ä½œæˆï¼ˆæ±äº¬ãƒªãƒ¼ã‚¸ãƒ§ãƒ³æ¨å¥¨ï¼‰
turso db create autoforgenexus-production --location aws-ap-northeast-1

# æˆåŠŸãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ä¾‹:
# Created database autoforgenexus-production at group default in aws-ap-northeast-1 (Tokyo, Japan)
```

### 4-2. æ¥ç¶šæƒ…å ±å–å¾—

```bash
# ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹URLå–å¾—
turso db show autoforgenexus-production --url

# å‡ºåŠ›ä¾‹:
# libsql://autoforgenexus-production-your-org.turso.io
```

**ã“ã®URLã‚’ã‚³ãƒ”ãƒ¼ã—ã¦ä¿å­˜ã—ã¦ãã ã•ã„ï¼**

### 4-3. èªè¨¼ãƒˆãƒ¼ã‚¯ãƒ³ç”Ÿæˆ

```bash
# æœ¬ç•ªç’°å¢ƒç”¨èªè¨¼ãƒˆãƒ¼ã‚¯ãƒ³ç”Ÿæˆï¼ˆæœ‰åŠ¹æœŸé™ãªã—ï¼‰
turso db tokens create autoforgenexus-production

# å‡ºåŠ›ã•ã‚ŒãŸãƒˆãƒ¼ã‚¯ãƒ³ã‚’ã™ãã«ä¿å­˜ï¼
```

âš ï¸ **æœ¬ç•ªç’°å¢ƒã®æ¨å¥¨è¨­å®š**: 90æ—¥é–“æœ‰åŠ¹ãªãƒˆãƒ¼ã‚¯ãƒ³ã‚’ä½¿ç”¨ã—ã€å®šæœŸçš„ã«ãƒ­ãƒ¼ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³

```bash
# 90æ—¥é–“æœ‰åŠ¹ãªæœ¬ç•ªãƒˆãƒ¼ã‚¯ãƒ³
turso db tokens create autoforgenexus-production --expiration 90d
```

### 4-4. ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æƒ…å ±ç¢ºèª

```bash
# æœ¬ç•ªç’°å¢ƒãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹è©³ç´°è¡¨ç¤º
turso db show autoforgenexus-production

# å‡ºåŠ›ä¾‹:
# Name:           autoforgenexus-production
# URL:            libsql://autoforgenexus-production-your-org.turso.io
# ID:             xxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx
# Group:          default
# Version:        0.24.28
# Locations:      nrt (Tokyo)
# Size:           0 B
```

## ã‚¹ãƒ†ãƒƒãƒ—5: ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ¥ç¶šç¢ºèª

### 5-1. Turso CLIçµŒç”±ã§æ¥ç¶š

```bash
# ã‚¹ãƒ†ãƒ¼ã‚¸ãƒ³ã‚°ç’°å¢ƒæ¥ç¶š
turso db shell autoforgenexus-staging

# SQLå®Ÿè¡Œãƒ†ã‚¹ãƒˆ
sqlite> SELECT 'Staging DB Connected!' AS message;
# æœŸå¾…ã•ã‚Œã‚‹å‡ºåŠ›: Staging DB Connected!

# çµ‚äº†
sqlite> .quit
```

```bash
# æœ¬ç•ªç’°å¢ƒæ¥ç¶š
turso db shell autoforgenexus-production

sqlite> SELECT 'Production DB Connected!' AS message;
# æœŸå¾…ã•ã‚Œã‚‹å‡ºåŠ›: Production DB Connected!

sqlite> .quit
```

### 5-2. Python SDKçµŒç”±ã§æ¥ç¶šç¢ºèª

#### ğŸ³ æ–¹æ³•A: Dockerç’°å¢ƒã§ç¢ºèªï¼ˆæ¨å¥¨ï¼‰

```bash
# ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒ«ãƒ¼ãƒˆã«ç§»å‹•
cd /Users/dm/dev/dev/å€‹äººé–‹ç™º/AutoForgeNexus

# Dockerç’°å¢ƒèµ·å‹•
docker compose -f docker-compose.dev.yml up -d

# ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã‚³ãƒ³ãƒ†ãƒŠã«å…¥ã‚‹
docker compose -f docker-compose.dev.yml exec backend bash

# ä»¥ä¸‹ã€ã‚³ãƒ³ãƒ†ãƒŠå†…ã§å®Ÿè¡Œ:

# æ¥ç¶šãƒ†ã‚¹ãƒˆã‚¹ã‚¯ãƒªãƒ—ãƒˆä½œæˆ
cat > test_turso_connection.py << 'EOF'
import os
import libsql_client

# ç’°å¢ƒå¤‰æ•°ã‹ã‚‰æ¥ç¶šæƒ…å ±å–å¾—
db_url = os.getenv("TURSO_DATABASE_URL")
auth_token = os.getenv("TURSO_AUTH_TOKEN")

print(f"Connecting to: {db_url}")

try:
    client = libsql_client.create_client_sync(
        url=db_url,
        auth_token=auth_token
    )
    result = client.execute("SELECT 'Connection OK' AS status")
    print(f"âœ… Database Connection: {result.rows[0]['status']}")
    print(f"âœ… Database URL: {db_url}")
except Exception as e:
    print(f"âŒ Database Connection Error: {e}")
EOF

# ã‚¹ãƒ†ãƒ¼ã‚¸ãƒ³ã‚°ç’°å¢ƒã§å®Ÿè¡Œ
export $(cat .env.staging | grep TURSO | xargs)
python test_turso_connection.py

# æœŸå¾…ã•ã‚Œã‚‹å‡ºåŠ›:
# Connecting to: libsql://autoforgenexus-staging-your-org.turso.io
# âœ… Database Connection: Connection OK
# âœ… Database URL: libsql://autoforgenexus-staging-your-org.turso.io

# æœ¬ç•ªç’°å¢ƒã§å®Ÿè¡Œ
export $(cat .env.production | grep TURSO | xargs)
python test_turso_connection.py

# æœŸå¾…ã•ã‚Œã‚‹å‡ºåŠ›:
# Connecting to: libsql://autoforgenexus-production-your-org.turso.io
# âœ… Database Connection: Connection OK
# âœ… Database URL: libsql://autoforgenexus-production-your-org.turso.io

# ã‚³ãƒ³ãƒ†ãƒŠã‹ã‚‰å‡ºã‚‹
exit

# Dockerç’°å¢ƒåœæ­¢
docker compose -f docker-compose.dev.yml down
```

#### ğŸ’» æ–¹æ³•B: ãƒ­ãƒ¼ã‚«ãƒ«ç’°å¢ƒã§ç¢ºèªï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼‰

```bash
# ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒ«ãƒ¼ãƒˆã«ç§»å‹•
cd /Users/dm/dev/dev/å€‹äººé–‹ç™º/AutoForgeNexus/backend

# Pythonä»®æƒ³ç’°å¢ƒä½œæˆï¼ˆåˆå›ã®ã¿ï¼‰
python3.13 -m venv venv

# Pythonä»®æƒ³ç’°å¢ƒã‚¢ã‚¯ãƒ†ã‚£ãƒ™ãƒ¼ãƒˆ
source venv/bin/activate

# libsql-clientã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
pip install libsql-client

# æ¥ç¶šãƒ†ã‚¹ãƒˆã‚¹ã‚¯ãƒªãƒ—ãƒˆä½œæˆï¼ˆä¸Šè¨˜ã¨åŒã˜ã‚¹ã‚¯ãƒªãƒ—ãƒˆï¼‰
cat > test_turso_connection.py << 'EOF'
import os
import libsql_client

db_url = os.getenv("TURSO_DATABASE_URL")
auth_token = os.getenv("TURSO_AUTH_TOKEN")

print(f"Connecting to: {db_url}")

try:
    client = libsql_client.create_client_sync(
        url=db_url,
        auth_token=auth_token
    )
    result = client.execute("SELECT 'Connection OK' AS status")
    print(f"âœ… Database Connection: {result.rows[0]['status']}")
except Exception as e:
    print(f"âŒ Database Connection Error: {e}")
EOF

# ã‚¹ãƒ†ãƒ¼ã‚¸ãƒ³ã‚°ç’°å¢ƒã§å®Ÿè¡Œ
export $(cat .env.staging | grep TURSO | xargs)
python test_turso_connection.py

# æœ¬ç•ªç’°å¢ƒã§å®Ÿè¡Œ
export $(cat .env.production | grep TURSO | xargs)
python test_turso_connection.py

# ä»®æƒ³ç’°å¢ƒã‹ã‚‰å‡ºã‚‹
deactivate
```

#### ğŸ“Š é–‹ç™ºç’°å¢ƒã®é¸æŠåŸºæº–

| ç”¨é€”               | æ¨å¥¨ç’°å¢ƒ    | ç†ç”±                       |
| ------------------ | ----------- | -------------------------- |
| **é€šå¸¸ã®é–‹ç™ºä½œæ¥­** | ğŸ³ Docker   | æœ¬ç•ªã¨åŒã˜ç’°å¢ƒã€ãƒãƒ¼ãƒ çµ±ä¸€ |
| **ã‚¯ã‚¤ãƒƒã‚¯ãƒ†ã‚¹ãƒˆ** | ğŸ’» ãƒ­ãƒ¼ã‚«ãƒ« | èµ·å‹•ãŒé€Ÿã„ã€è»½é‡           |
| **ãƒ‡ãƒãƒƒã‚°ä½œæ¥­**   | ğŸ’» ãƒ­ãƒ¼ã‚«ãƒ« | ãƒ‡ãƒãƒƒã‚¬ãƒ¼ä½¿ç”¨ãŒå®¹æ˜“       |
| **CI/CD**          | ğŸ³ Docker   | ä¸€è²«æ€§ã®ã‚ã‚‹ç’°å¢ƒ           |
| **æœ¬ç•ªç’°å¢ƒ**       | ğŸ³ Docker   | å®Œå…¨ãªç’°å¢ƒå†ç¾æ€§           |

âš ï¸
**æ¨å¥¨**: ç‰¹åˆ¥ãªç†ç”±ãŒãªã„é™ã‚Š**Dockerç’°å¢ƒ**ã‚’ä½¿ç”¨ã—ã¦ãã ã•ã„ã€‚æœ¬ç•ªç’°å¢ƒã¨ã®ä¸€è²«æ€§ãŒä¿ãŸã‚Œã¾ã™ã€‚

---

# ğŸ”§ ç’°å¢ƒå¤‰æ•°ã®çµ±åˆè¨­å®š

## ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ç’°å¢ƒå¤‰æ•°

### Developmentç’°å¢ƒï¼ˆbackend/.env.localï¼‰

```bash
cd /Users/dm/dev/dev/å€‹äººé–‹ç™º/AutoForgeNexus/backend

cat > .env.local << 'EOF'
# ============================================
# Application Settings
# ============================================
APP_NAME=AutoForgeNexus-Backend-Dev
APP_ENV=local
DEBUG=true
LOG_LEVEL=DEBUG
PORT=8000
HOST=0.0.0.0

# ============================================
# Database Configuration (Turso/libSQL)
# ============================================
# é–‹ç™ºç’°å¢ƒ: ãƒ­ãƒ¼ã‚«ãƒ«SQLiteä½¿ç”¨ï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼‰
DATABASE_URL=sqlite:///./data/local.db

# ã¾ãŸã¯ Tursoé–‹ç™ºç”¨DBä½¿ç”¨
# DATABASE_URL=libsql://autoforgenexus-dev-[your-org].turso.io
# TURSO_DATABASE_URL=libsql://autoforgenexus-dev-[your-org].turso.io
# TURSO_AUTH_TOKEN=eyJhbGciOiJFZERTQSIsInR5cCI6IkpXVCJ9...

# ============================================
# Cache (Redis)
# ============================================
REDIS_HOST=localhost
REDIS_PORT=6379
REDIS_PASSWORD=
REDIS_DB=0
REDIS_CACHE_TTL=3600

# ============================================
# Authentication (Clerk Backend)
# ============================================
CLERK_SECRET_KEY=sk_test_xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
CLERK_PUBLIC_KEY=pk_test_xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
CLERK_WEBHOOK_SECRET=whsec_xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx

# ============================================
# JWT Configuration
# ============================================
JWT_SECRET_KEY=dev-jwt-secret-key-min-32-chars-xxxxxxxxxxxxxxxx
JWT_ALGORITHM=HS256
JWT_ACCESS_TOKEN_EXPIRE_MINUTES=30

# ============================================
# Security Settings
# ============================================
CORS_ORIGINS=http://localhost:3000,http://127.0.0.1:3000
CORS_CREDENTIALS=true
EOF

chmod 600 .env.local
echo "âœ… backend/.env.local created"
```

### Stagingç’°å¢ƒï¼ˆbackend/.env.stagingï¼‰

```bash
cat > .env.staging << 'EOF'
# ============================================
# Application Settings
# ============================================
APP_NAME=AutoForgeNexus-Backend-Staging
APP_ENV=staging
DEBUG=false
LOG_LEVEL=INFO
PORT=8000
HOST=0.0.0.0

# ============================================
# Database Configuration (Turso/libSQL Staging)
# ============================================
DATABASE_URL=libsql://autoforgenexus-staging-[your-org].turso.io
TURSO_DATABASE_URL=libsql://autoforgenexus-staging-[your-org].turso.io
TURSO_AUTH_TOKEN=eyJhbGciOiJFZERTQSIsInR5cCI6IkpXVCJ9...ï¼ˆã‚¹ãƒ†ãƒ¼ã‚¸ãƒ³ã‚°ç”¨ãƒˆãƒ¼ã‚¯ãƒ³ï¼‰

# ============================================
# Cache (Redis) - Upstash Staging
# ============================================
REDIS_HOST=your-staging-redis.upstash.io
REDIS_PORT=6379
REDIS_PASSWORD=staging_redis_password_xxxxxxxxxx
REDIS_DB=0

# ============================================
# Authentication (Clerk Staging)
# ============================================
CLERK_SECRET_KEY=sk_test_STAGING_xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
CLERK_PUBLIC_KEY=pk_test_STAGING_xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx

# ============================================
# JWT Configuration
# ============================================
JWT_SECRET_KEY=staging-jwt-secret-key-min-32-chars-xxxxxxxxxxxxxxxx
JWT_ALGORITHM=HS256
JWT_ACCESS_TOKEN_EXPIRE_MINUTES=30

# ============================================
# Security Settings
# ============================================
CORS_ORIGINS=https://staging.autoforgenexus.com,https://staging-api.autoforgenexus.com
CORS_CREDENTIALS=true
EOF

chmod 600 .env.staging
echo "âœ… backend/.env.staging created"
```

### Productionç’°å¢ƒï¼ˆbackend/.env.productionï¼‰

```bash
cat > .env.production << 'EOF'
# ============================================
# Application Settings
# ============================================
APP_NAME=AutoForgeNexus-Backend-Production
APP_ENV=production
DEBUG=false
LOG_LEVEL=WARNING
PORT=8000
HOST=0.0.0.0

# ============================================
# Database Configuration (Turso/libSQL Production)
# ============================================
DATABASE_URL=libsql://autoforgenexus-production-[your-org].turso.io
TURSO_DATABASE_URL=libsql://autoforgenexus-production-[your-org].turso.io
TURSO_AUTH_TOKEN=eyJhbGciOiJFZERTQSIsInR5cCI6IkpXVCJ9...ï¼ˆæœ¬ç•ªç”¨ãƒˆãƒ¼ã‚¯ãƒ³ï¼‰

# ============================================
# Cache (Redis) - Upstash Production
# ============================================
REDIS_HOST=your-production-redis.upstash.io
REDIS_PORT=6379
REDIS_PASSWORD=production_redis_password_STRONG_xxxxxxxxxxxxxxxx
REDIS_DB=0

# ============================================
# Authentication (Clerk Production)
# ============================================
CLERK_SECRET_KEY=sk_live_PRODUCTION_xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
CLERK_PUBLIC_KEY=pk_live_PRODUCTION_xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx

# ============================================
# JWT Configuration (Production)
# ============================================
JWT_SECRET_KEY=production-jwt-secret-STRONG-64-chars-min-xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
JWT_ALGORITHM=HS256
JWT_ACCESS_TOKEN_EXPIRE_MINUTES=15

# ============================================
# Security Settings (Production Hardened)
# ============================================
CORS_ORIGINS=https://autoforgenexus.com,https://api.autoforgenexus.com
CORS_CREDENTIALS=true
EOF

chmod 600 .env.production
echo "âœ… backend/.env.production created"
```

## ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ç’°å¢ƒå¤‰æ•°

### Developmentç’°å¢ƒï¼ˆfrontend/.env.localï¼‰

```bash
cd /Users/dm/dev/dev/å€‹äººé–‹ç™º/AutoForgeNexus/frontend

cat > .env.local << 'EOF'
# ============================================
# Clerk Authentication (Development)
# ============================================
CLERK_SECRET_KEY=sk_test_xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
NEXT_PUBLIC_CLERK_PUBLISHABLE_KEY=pk_test_xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx

# ============================================
# Clerk Redirect URLs
# ============================================
NEXT_PUBLIC_CLERK_SIGN_IN_URL=/sign-in
NEXT_PUBLIC_CLERK_SIGN_UP_URL=/sign-up
NEXT_PUBLIC_CLERK_AFTER_SIGN_IN_URL=/dashboard
NEXT_PUBLIC_CLERK_AFTER_SIGN_UP_URL=/dashboard

# ============================================
# Environment
# ============================================
NODE_ENV=development
NEXT_PUBLIC_APP_URL=http://localhost:3000
NEXT_PUBLIC_API_URL=http://localhost:8000

# ============================================
# Database (Optional: Direct Frontend Access)
# ============================================
# DATABASE_URL=sqlite:///./data/local.db
EOF

chmod 600 .env.local
echo "âœ… frontend/.env.local created"
```

### Stagingç’°å¢ƒï¼ˆfrontend/.env.stagingï¼‰

```bash
cat > .env.staging << 'EOF'
# ============================================
# Clerk Authentication (Staging)
# ============================================
CLERK_SECRET_KEY=sk_test_STAGING_xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
NEXT_PUBLIC_CLERK_PUBLISHABLE_KEY=pk_test_STAGING_xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx

# ============================================
# Clerk Redirect URLs (Staging)
# ============================================
NEXT_PUBLIC_CLERK_SIGN_IN_URL=/sign-in
NEXT_PUBLIC_CLERK_SIGN_UP_URL=/sign-up
NEXT_PUBLIC_CLERK_AFTER_SIGN_IN_URL=/dashboard
NEXT_PUBLIC_CLERK_AFTER_SIGN_UP_URL=/onboarding

# ============================================
# Environment
# ============================================
NODE_ENV=production
NEXT_PUBLIC_APP_URL=https://staging.autoforgenexus.com
NEXT_PUBLIC_API_URL=https://staging-api.autoforgenexus.com

# ============================================
# Database & Backend (Staging)
# ============================================
DATABASE_URL=libsql://autoforgenexus-staging-[your-org].turso.io
TURSO_AUTH_TOKEN=eyJhbGciOiJFZERTQSIsInR5cCI6IkpXVCJ9...ï¼ˆã‚¹ãƒ†ãƒ¼ã‚¸ãƒ³ã‚°ç”¨ãƒˆãƒ¼ã‚¯ãƒ³ï¼‰
EOF

chmod 600 .env.staging
echo "âœ… frontend/.env.staging created"
```

### Productionç’°å¢ƒï¼ˆfrontend/.env.productionï¼‰

```bash
cat > .env.production << 'EOF'
# ============================================
# Clerk Authentication (Production)
# ============================================
CLERK_SECRET_KEY=sk_live_PRODUCTION_xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
NEXT_PUBLIC_CLERK_PUBLISHABLE_KEY=pk_live_PRODUCTION_xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx

# ============================================
# Clerk Redirect URLs (Production)
# ============================================
NEXT_PUBLIC_CLERK_SIGN_IN_URL=/sign-in
NEXT_PUBLIC_CLERK_SIGN_UP_URL=/sign-up
NEXT_PUBLIC_CLERK_AFTER_SIGN_IN_URL=/dashboard
NEXT_PUBLIC_CLERK_AFTER_SIGN_UP_URL=/onboarding

# ============================================
# Environment
# ============================================
NODE_ENV=production
NEXT_PUBLIC_APP_URL=https://autoforgenexus.com
NEXT_PUBLIC_API_URL=https://api.autoforgenexus.com

# ============================================
# Database & Backend (Production)
# ============================================
DATABASE_URL=libsql://autoforgenexus-production-[your-org].turso.io
TURSO_AUTH_TOKEN=eyJhbGciOiJFZERTQSIsInR5cCI6IkpXVCJ9...ï¼ˆæœ¬ç•ªç”¨ãƒˆãƒ¼ã‚¯ãƒ³ï¼‰
EOF

chmod 600 .env.production
echo "âœ… frontend/.env.production created"
```

---

# âœ… æ¥ç¶šç¢ºèªã¨ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°

## çµ±åˆæ¥ç¶šç¢ºèª

### 1. Clerkèªè¨¼ç¢ºèª

```bash
# ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰èµ·å‹•
cd /Users/dm/dev/dev/å€‹äººé–‹ç™º/AutoForgeNexus/frontend
pnpm dev

# ãƒ–ãƒ©ã‚¦ã‚¶ã§ç¢ºèª
open http://localhost:3000

# æœŸå¾…ã•ã‚Œã‚‹å‹•ä½œ:
# 1. Clerkãƒ­ã‚°ã‚¤ãƒ³ç”»é¢ãŒè¡¨ç¤ºã•ã‚Œã‚‹
# 2. ã‚µã‚¤ãƒ³ã‚¢ãƒƒãƒ—/ã‚µã‚¤ãƒ³ã‚¤ãƒ³ãŒæ­£å¸¸ã«å‹•ä½œ
# 3. ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã«ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆã•ã‚Œã‚‹
```

### 2. Tursoãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ç¢ºèª

```bash
# ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰èµ·å‹•
cd /Users/dm/dev/dev/å€‹äººé–‹ç™º/AutoForgeNexus/backend
source venv/bin/activate
uvicorn src.main:app --reload

# ãƒ˜ãƒ«ã‚¹ãƒã‚§ãƒƒã‚¯ç¢ºèª
curl http://localhost:8000/health

# æœŸå¾…ã•ã‚Œã‚‹å‡ºåŠ›:
# {
#   "status": "healthy",
#   "database": "connected",
#   "turso": "OK",
#   "timestamp": "2025-09-30T12:00:00Z"
# }
```

### 3. ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³å®Ÿè¡Œ

```bash
cd /Users/dm/dev/dev/å€‹äººé–‹ç™º/AutoForgeNexus/backend
source venv/bin/activate

# ã‚¹ãƒ†ãƒ¼ã‚¸ãƒ³ã‚°ç’°å¢ƒã«ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³é©ç”¨
export $(cat .env.staging | grep -E 'TURSO|DATABASE' | xargs)
alembic upgrade head

# æœŸå¾…ã•ã‚Œã‚‹å‡ºåŠ›:
# INFO  [alembic.runtime.migration] Running upgrade -> xxxxx, Initial migration
# âœ… Staging database migrated successfully

# æœ¬ç•ªç’°å¢ƒã«ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³é©ç”¨
export $(cat .env.production | grep -E 'TURSO|DATABASE' | xargs)
alembic upgrade head

# âœ… Production database migrated successfully
```

## ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°

### ã‚¨ãƒ©ãƒ¼: Clerk authentication failed

**åŸå› **: API KeyãŒæ­£ã—ãè¨­å®šã•ã‚Œã¦ã„ãªã„

**è§£æ±ºç­–**:

```bash
# 1. Clerk Dashboardã§æ­£ã—ã„ã‚­ãƒ¼ã‚’ç¢ºèª
# 2. ç’°å¢ƒå¤‰æ•°ãƒ•ã‚¡ã‚¤ãƒ«ã‚’å†ç¢ºèª
cat backend/.env.local | grep CLERK
cat frontend/.env.local | grep CLERK

# 3. ã‚­ãƒ¼ã‚’æ­£ã—ãè¨­å®šã—ã¦å†èµ·å‹•
```

### ã‚¨ãƒ©ãƒ¼: Turso connection refused

**åŸå› **: èªè¨¼ãƒˆãƒ¼ã‚¯ãƒ³ãŒç„¡åŠ¹ã¾ãŸã¯æœŸé™åˆ‡ã‚Œ

**è§£æ±ºç­–**:

```bash
# æ–°ã—ã„ãƒˆãƒ¼ã‚¯ãƒ³ã‚’ç”Ÿæˆ
turso db tokens create autoforgenexus-staging

# ç’°å¢ƒå¤‰æ•°ãƒ•ã‚¡ã‚¤ãƒ«ã‚’æ›´æ–°
nano backend/.env.staging
# TURSO_AUTH_TOKEN=æ–°ã—ã„ãƒˆãƒ¼ã‚¯ãƒ³

# ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³å†èµ·å‹•
```

### ã‚¨ãƒ©ãƒ¼: DNS validation failed (Clerk)

**åŸå› **: DNSãƒ¬ã‚³ãƒ¼ãƒ‰ãŒæ­£ã—ãè¨­å®šã•ã‚Œã¦ã„ãªã„

**è§£æ±ºç­–**:

```bash
# DNSä¼æ’­ç¢ºèª
dig clerk.autoforgenexus.com CNAME +short
# æœŸå¾…ã•ã‚Œã‚‹å‡ºåŠ›: clerk.shared.lcl.dev

# Cloudflareã®å ´åˆã€Proxyã‚’ã‚ªãƒ•ã«ã™ã‚‹
# Dashboard â†’ DNS â†’ Proxyã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹: DNS onlyï¼ˆã‚°ãƒ¬ãƒ¼é›²ãƒãƒ¼ã‚¯ï¼‰
```

---

## ğŸ“Š ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—å®Œäº†ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ

### Clerkèªè¨¼

- [ ] Clerkã‚¢ã‚«ã‚¦ãƒ³ãƒˆä½œæˆå®Œäº†
- [ ] Development API Keyså–å¾—å®Œäº†
- [ ] Production API Keyså–å¾—å®Œäº†
- [ ] ãƒ‰ãƒ¡ã‚¤ãƒ³è¨­å®šå®Œäº†ï¼ˆProductionï¼‰
- [ ] DNSè¨­å®šå®Œäº†ï¼ˆ5ã¤ã®ãƒ¬ã‚³ãƒ¼ãƒ‰ï¼‰
- [ ] SSLè¨¼æ˜æ›¸ãƒ‡ãƒ—ãƒ­ã‚¤å®Œäº†
- [ ] ãƒ­ãƒ¼ã‚«ãƒ«èªè¨¼å‹•ä½œç¢ºèªå®Œäº†

### Tursoãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹

- [ ] Turso CLI ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«å®Œäº†
- [ ] Tursoèªè¨¼å®Œäº†
- [ ] ã‚¹ãƒ†ãƒ¼ã‚¸ãƒ³ã‚°DBä½œæˆå®Œäº†
- [ ] ã‚¹ãƒ†ãƒ¼ã‚¸ãƒ³ã‚°ãƒˆãƒ¼ã‚¯ãƒ³ç”Ÿæˆãƒ»ä¿å­˜å®Œäº†
- [ ] æœ¬ç•ªDBä½œæˆå®Œäº†
- [ ] æœ¬ç•ªãƒˆãƒ¼ã‚¯ãƒ³ç”Ÿæˆãƒ»ä¿å­˜å®Œäº†
- [ ] CLIæ¥ç¶šç¢ºèªå®Œäº†
- [ ] Python SDKæ¥ç¶šç¢ºèªå®Œäº†

### ç’°å¢ƒå¤‰æ•°è¨­å®š

- [ ] backend/.env.local ä½œæˆå®Œäº†
- [ ] backend/.env.staging ä½œæˆå®Œäº†
- [ ] backend/.env.production ä½œæˆå®Œäº†
- [ ] frontend/.env.local ä½œæˆå®Œäº†
- [ ] frontend/.env.staging ä½œæˆå®Œäº†
- [ ] frontend/.env.production ä½œæˆå®Œäº†
- [ ] ã™ã¹ã¦ã®ãƒ•ã‚¡ã‚¤ãƒ«æ¨©é™600è¨­å®šå®Œäº†

### çµ±åˆç¢ºèª

- [ ] Clerkèªè¨¼ãƒ•ãƒ­ãƒ¼å‹•ä½œç¢ºèªå®Œäº†
- [ ] Tursoãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ¥ç¶šç¢ºèªå®Œäº†
- [ ] ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³å®Œäº†
- [ ] ãƒ˜ãƒ«ã‚¹ãƒã‚§ãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆæ­£å¸¸å¿œç­”

---

## ğŸ” ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹

### 1. API Keyç®¡ç†

```bash
# âŒ çµ¶å¯¾ã«ã‚„ã£ã¦ã¯ã„ã‘ãªã„ã“ã¨
git add .env.local
git add .env.staging
git add .env.production
git commit -m "add env files"  # çµ¶å¯¾NGï¼

# âœ… æ­£ã—ã„ç®¡ç†æ–¹æ³•
echo ".env.*" >> .gitignore
echo ".env.local" >> .gitignore
echo ".env.staging" >> .gitignore
echo ".env.production" >> .gitignore

# Gitå±¥æ­´ã‹ã‚‰å‰Šé™¤ï¼ˆã‚‚ã—ã‚³ãƒŸãƒƒãƒˆã—ã¦ã—ã¾ã£ãŸå ´åˆï¼‰
git filter-branch --force --index-filter \
  "git rm --cached --ignore-unmatch .env.*" \
  --prune-empty --tag-name-filter cat -- --all
```

### 2. ãƒˆãƒ¼ã‚¯ãƒ³ãƒ­ãƒ¼ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³

```bash
# 90æ—¥ã”ã¨ã«ãƒˆãƒ¼ã‚¯ãƒ³ã‚’æ›´æ–°ï¼ˆæ¨å¥¨ï¼‰
turso db tokens create autoforgenexus-production --expiration 90d

# å¤ã„ãƒˆãƒ¼ã‚¯ãƒ³ã‚’ç„¡åŠ¹åŒ–
turso db tokens list autoforgenexus-production
turso db tokens revoke autoforgenexus-production <TOKEN_NAME>
```

### 3. ç§˜å¯†æƒ…å ±ã®å®‰å…¨ãªä¿å­˜

- **1Password**: ãƒãƒ¼ãƒ å…¨ä½“ã§ç§˜å¯†æƒ…å ±ã‚’å…±æœ‰
- **GitHub Secrets**: CI/CDç”¨ã®ç’°å¢ƒå¤‰æ•°
- **Cloudflareç’°å¢ƒå¤‰æ•°**: ãƒ‡ãƒ—ãƒ­ã‚¤å…ˆã®ç’°å¢ƒå¤‰æ•°

---

## ğŸš€ æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—

1. **Next.jsçµ±åˆã‚³ãƒ¼ãƒ‰å®Ÿè£…**

   - `middleware.ts` - ãƒ«ãƒ¼ãƒˆä¿è­·
   - `layout.tsx` - ClerkProviderãƒ©ãƒƒãƒ—
   - ã‚µã‚¤ãƒ³ã‚¤ãƒ³/ã‚µã‚¤ãƒ³ã‚¢ãƒƒãƒ—ãƒšãƒ¼ã‚¸ä½œæˆ

2. **ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚¹ã‚­ãƒ¼ãƒè¨­è¨ˆ**

   - Alembicãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãƒ•ã‚¡ã‚¤ãƒ«ä½œæˆ
   - ãƒ¢ãƒ‡ãƒ«å®šç¾©ï¼ˆSQLAlchemyï¼‰

3. **GitHub Secretsã«ç™»éŒ²**ï¼ˆCI/CDç”¨ï¼‰

   ```bash
   gh secret set CLERK_SECRET_KEY_PRODUCTION
   gh secret set TURSO_AUTH_TOKEN_PRODUCTION
   ```

4. **Cloudflareç’°å¢ƒå¤‰æ•°è¨­å®š**ï¼ˆãƒ‡ãƒ—ãƒ­ã‚¤ç”¨ï¼‰
   ```bash
   wrangler secret put CLERK_SECRET_KEY
   wrangler secret put TURSO_AUTH_TOKEN
   ```

---

## ğŸ“š å‚è€ƒè³‡æ–™

- [Clerkå…¬å¼ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ](https://clerk.com/docs)
- [Tursoå…¬å¼ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ](https://docs.turso.tech)
- [libSQL Python SDK](https://github.com/tursodatabase/libsql-client-py)
- [Alembicå…¬å¼ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ](https://alembic.sqlalchemy.org)

---

**æœ€çµ‚æ›´æ–°æ—¥**: 2025å¹´9æœˆ30æ—¥ **ä½œæˆè€…**: AutoForgeNexusé–‹ç™ºãƒãƒ¼ãƒ 
