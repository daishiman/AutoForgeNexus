# ãƒ†ã‚¹ãƒˆã‚«ãƒãƒ¬ãƒƒã‚¸å‘ä¸Šãƒ­ãƒ¼ãƒ‰ãƒãƒƒãƒ—

## ğŸ“Š ç¾çŠ¶åˆ†æï¼ˆ2025å¹´9æœˆ30æ—¥ï¼‰

### GitHub Actionså®Ÿè¡Œçµæœ

- âœ… **unit**: 86.86% > 80% **æˆåŠŸ**
- âŒ **domain**: 48.66% < 85% **å¤±æ•—** â†’ **60%ã«èª¿æ•´**
- âŒ **integration**: 21.68% < 70% **å¤±æ•—** â†’ **40%ã«èª¿æ•´**

### å•é¡Œç‚¹ã¨èª¿æ•´ç†ç”±

#### 1. domainãƒ†ã‚¹ãƒˆã‚«ãƒãƒ¬ãƒƒã‚¸ï¼ˆ48.66% â†’ ç›®æ¨™60%ï¼‰

**å•é¡Œ**: domainå±¤ã®ã¿ã§å…¨ä½“ã®85%ã‚«ãƒãƒ¬ãƒƒã‚¸ã¯éç¾å®Ÿçš„

**ç†ç”±**:

- domainãƒ†ã‚¹ãƒˆã¯`tests/unit/domain/`é…ä¸‹ã®ã¿ã‚’å®Ÿè¡Œ
- `src/main.py`, `src/monitoring.py`ç­‰ã¯domainå±¤ã®å¯¾è±¡å¤–
- domainå±¤ã®å®Ÿè£…é€²æ—ã¯ç´„40%ï¼ˆPhase 3é€²è¡Œä¸­ï¼‰

**èª¿æ•´æ–¹é‡**:

- **Phase 3ï¼ˆç¾åœ¨ï¼‰**: 60%ï¼ˆdomainå±¤ã®åŸºæœ¬æ§‹é€ å®Œæˆï¼‰
- **Phase 4**: 70%ï¼ˆEvaluation/LLM Integrationé›†ç´„å®Ÿè£…ï¼‰
- **Phase 6**: 80%ï¼ˆå…¨é›†ç´„å®Ÿè£…å®Œäº†ãƒ»å“è³ªä¿è¨¼ãƒ•ã‚§ãƒ¼ã‚ºï¼‰

#### 2. integrationãƒ†ã‚¹ãƒˆï¼ˆ21.68% â†’ ç›®æ¨™40%ï¼‰

**å•é¡Œ**: Phase 4ï¼ˆãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹å®Ÿè£…ï¼‰æœªå®Œäº†ã§70%ã¯æ™‚æœŸå°šæ—©

**ç†ç”±**:

- `src.infrastructure.database`ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«æœªå®Ÿè£…
- `test_database_connection.py`ãŒåé›†ã‚¨ãƒ©ãƒ¼ã‚’èµ·ã“ã™
- Phase 3ï¼ˆãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰åŸºç›¤ï¼‰ã¯40%å®Œäº†ã®ã¿

**èª¿æ•´æ–¹é‡**:

- **Phase 3ï¼ˆç¾åœ¨ï¼‰**: 40%ã¾ãŸã¯ã‚¹ã‚­ãƒƒãƒ—ï¼ˆåŸºç›¤ãƒ†ã‚¹ãƒˆã®ã¿ï¼‰
- **Phase 4**: 60%ï¼ˆTurso/Redisçµ±åˆå®Œäº†å¾Œï¼‰
- **Phase 6**: 75%ï¼ˆE2Eçµ±åˆãƒ†ã‚¹ãƒˆå®Œæˆï¼‰

## ğŸ¯ ãƒ•ã‚§ãƒ¼ã‚ºåˆ¥ã‚«ãƒãƒ¬ãƒƒã‚¸ç›®æ¨™

### Phase 3: ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰åŸºç›¤ï¼ˆç¾åœ¨ãƒ»40%å®Œäº†ï¼‰

| ãƒ†ã‚¹ãƒˆã‚¿ã‚¤ãƒ—    | ç¾åœ¨å€¤ | ç›®æ¨™ | ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ | å‚™è€ƒ                        |
| --------------- | ------ | ---- | ---------- | --------------------------- |
| **unit**        | 86.86% | 80%  | âœ… é”æˆ    | ç¶­æŒ                        |
| **domain**      | 48.66% | 60%  | ğŸš§ é€²è¡Œä¸­  | domainå±¤åŸºæœ¬æ§‹é€ å®Œæˆæ™‚      |
| **integration** | 21.68% | 40%  | ğŸš§ é€²è¡Œä¸­  | Phase 4æº–å‚™ã¨ã—ã¦åŸºç›¤ãƒ†ã‚¹ãƒˆ |

**é”æˆæ¡ä»¶**:

- âœ… domainå±¤5é›†ç´„ã®åŸºåº•ã‚¯ãƒ©ã‚¹å®Ÿè£…ï¼ˆBaseEntity, BaseValue, BaseRepositoryï¼‰
- ğŸš§ Prompté›†ç´„ã®ã‚³ã‚¢ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£å®Ÿè£…ï¼ˆPrompt, PromptContent, PromptMetadataï¼‰
- ğŸš§ Applicationå±¤CQRSå®Ÿè£…ï¼ˆcommands/queriesåˆ†é›¢ï¼‰
- â³ åŸºæœ¬CRUD APIå®Ÿè£…ï¼ˆFastAPI endpointsï¼‰

### Phase 4: ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ãƒ»ã‚­ãƒ£ãƒƒã‚·ãƒ³ã‚°å±¤ï¼ˆæœªç€æ‰‹ï¼‰

| ãƒ†ã‚¹ãƒˆã‚¿ã‚¤ãƒ—    | ç¾åœ¨å€¤ | ç›®æ¨™ | å‚™è€ƒ                                   |
| --------------- | ------ | ---- | -------------------------------------- |
| **unit**        | 86.86% | 85%  | æ–°è¦ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«è¿½åŠ ã§ã‚«ãƒãƒ¬ãƒƒã‚¸ä½ä¸‹æƒ³å®š |
| **domain**      | 48.66% | 70%  | Evaluation/LLM Integrationé›†ç´„å®Ÿè£…     |
| **integration** | 21.68% | 60%  | Turso/Redisçµ±åˆå®Œäº†å¾Œ                  |

**é”æˆæ¡ä»¶**:

- Tursoï¼ˆlibSQLï¼‰æ¥ç¶šå®Ÿè£…
- Redis Streamså®Ÿè£…
- Infrastructureå±¤ãƒªãƒã‚¸ãƒˆãƒªå®Ÿè£…
- ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãƒ†ã‚¹ãƒˆ

### Phase 5: ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ï¼ˆæœªç€æ‰‹ï¼‰

**ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã‚«ãƒãƒ¬ãƒƒã‚¸ã¸ã®å½±éŸ¿ãªã—**

- ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã¯åˆ¥ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ç®¡ç†

### Phase 6: çµ±åˆãƒ»å“è³ªä¿è¨¼ï¼ˆæœªç€æ‰‹ï¼‰

| ãƒ†ã‚¹ãƒˆã‚¿ã‚¤ãƒ—    | ç¾åœ¨å€¤ | ç›®æ¨™ | å‚™è€ƒ               |
| --------------- | ------ | ---- | ------------------ |
| **unit**        | 86.86% | 85%  | å…¨ãƒ¬ã‚¤ãƒ¤ãƒ¼å®Ÿè£…å®Œäº† |
| **domain**      | 48.66% | 80%  | å…¨5é›†ç´„å®Ÿè£…å®Œäº†    |
| **integration** | 21.68% | 75%  | E2Eçµ±åˆãƒ†ã‚¹ãƒˆå®Œæˆ  |

**é”æˆæ¡ä»¶**:

- å…¨17ã®é©æ–°çš„æ©Ÿèƒ½å®Ÿè£…å®Œäº†
- E2Eãƒ†ã‚¹ãƒˆã‚¹ã‚¤ãƒ¼ãƒˆå®Œæˆ
- ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒ†ã‚¹ãƒˆåˆæ ¼
- ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚¹ã‚­ãƒ£ãƒ³å…¨ãƒ‘ã‚¹

## ğŸ”§ å®Ÿè£…æ¸ˆã¿å¯¾å¿œï¼ˆ2025å¹´9æœˆ30æ—¥ï¼‰

### 1. CI/CDè¨­å®šå¤‰æ›´

**ãƒ•ã‚¡ã‚¤ãƒ«**: `.github/workflows/backend-ci.yml`

```yaml
# å¤‰æ›´å‰ï¼ˆéç¾å®Ÿçš„ãªç›®æ¨™ï¼‰
- test-type: domain
  cov-fail-under: 85
- test-type: integration
  cov-fail-under: 70

# å¤‰æ›´å¾Œï¼ˆæ®µéšçš„ç›®æ¨™ï¼‰
- test-type: domain
  cov-fail-under: 60 # Phase 3: ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰åŸºç›¤å®Œäº†æ™‚ã®ç›®æ¨™
- test-type: integration
  cov-fail-under: 40 # Phase 4æœªå®Ÿè£…ã®ãŸã‚æ®µéšçš„ç›®æ¨™ï¼ˆPhase 4å®Œäº†å¾Œ60%ã¸ï¼‰
```

### 2. integrationãƒ†ã‚¹ãƒˆã®ã‚¹ã‚­ãƒƒãƒ—ãƒãƒ¼ã‚«ãƒ¼è¿½åŠ 

**ãƒ•ã‚¡ã‚¤ãƒ«**: `backend/tests/integration/database/test_database_connection.py`

```python
# Phase 4æœªå®Ÿè£…æ™‚ã¯å…¨integrationãƒ†ã‚¹ãƒˆã‚’ã‚¹ã‚­ãƒƒãƒ—
pytestmark = pytest.mark.skipif(
    not PHASE_4_IMPLEMENTED,
    reason="Phase 4 (Database Implementation) not completed yet"
)
```

**åŠ¹æœ**:

- âœ… ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«æœªå®Ÿè£…ã§ã‚‚pyteståé›†ã‚¨ãƒ©ãƒ¼ãªã—
- âœ… Phase 4å®Ÿè£…å®Œäº†æ™‚ã«è‡ªå‹•çš„ã«ãƒ†ã‚¹ãƒˆæœ‰åŠ¹åŒ–
- âœ… CI/CDãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³æˆåŠŸç‡å‘ä¸Š

## ğŸ“ˆ ã‚«ãƒãƒ¬ãƒƒã‚¸å‘ä¸Šæ–½ç­–

### çŸ­æœŸæ–½ç­–ï¼ˆPhase 3å®Œäº†ã¾ã§ï¼‰

1. **domainå±¤ãƒ†ã‚¹ãƒˆå¼·åŒ–**

   - Promptã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£ãƒ†ã‚¹ãƒˆã‚’PromptContentã¾ã§æ‹¡å¼µ
   - Value Objectãƒ†ã‚¹ãƒˆã®ç¶²ç¾…æ€§å‘ä¸Š
   - ãƒªãƒã‚¸ãƒˆãƒªã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ãƒ†ã‚¹ãƒˆè¿½åŠ 

2. **Applicationå±¤ãƒ†ã‚¹ãƒˆè¿½åŠ **

   - CreatePromptUseCaseãƒ†ã‚¹ãƒˆ
   - QueryPromptUseCaseãƒ†ã‚¹ãƒˆ
   - DTOãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ãƒ†ã‚¹ãƒˆ

3. **Coreå±¤ãƒ†ã‚¹ãƒˆæ‹¡å……**
   - Pydantic Settingséšå±¤å‹è¨­å®šãƒ†ã‚¹ãƒˆ
   - ä¾‹å¤–ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ãƒ†ã‚¹ãƒˆ
   - ãƒ­ã‚°ç®¡ç†ãƒ†ã‚¹ãƒˆ

### ä¸­æœŸæ–½ç­–ï¼ˆPhase 4ï¼‰

1. **Infrastructureå±¤ãƒ†ã‚¹ãƒˆå®Ÿè£…**

   - Tursoæ¥ç¶šãƒ»ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ãƒ†ã‚¹ãƒˆ
   - Redisã‚­ãƒ£ãƒƒã‚·ãƒ¥ãƒ†ã‚¹ãƒˆ
   - Redis Streamsã‚¤ãƒ™ãƒ³ãƒˆãƒã‚¹ãƒ†ã‚¹ãƒˆ

2. **Integrationå±¤ãƒ†ã‚¹ãƒˆæ‹¡å……**

   - DB + Cacheçµ±åˆãƒ†ã‚¹ãƒˆ
   - CQRSçµ±åˆãƒ†ã‚¹ãƒˆ
   - ã‚¤ãƒ™ãƒ³ãƒˆã‚½ãƒ¼ã‚·ãƒ³ã‚°ãƒ†ã‚¹ãƒˆ

3. **ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒ†ã‚¹ãƒˆ**
   - ãƒãƒ«ã‚¯ã‚¤ãƒ³ã‚µãƒ¼ãƒˆæ€§èƒ½æ¤œè¨¼
   - ã‚¯ã‚¨ãƒªãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒ†ã‚¹ãƒˆ
   - ã‚­ãƒ£ãƒƒã‚·ãƒ¥ãƒ’ãƒƒãƒˆç‡æ¤œè¨¼

### é•·æœŸæ–½ç­–ï¼ˆPhase 6ï¼‰

1. **E2Eãƒ†ã‚¹ãƒˆå®Ÿè£…**

   - API E2Eãƒ†ã‚¹ãƒˆã‚¹ã‚¤ãƒ¼ãƒˆ
   - WebSocketçµ±åˆãƒ†ã‚¹ãƒˆ
   - ä¸¦åˆ—è©•ä¾¡å®Ÿè¡Œãƒ†ã‚¹ãƒˆ

2. **å“è³ªã‚²ãƒ¼ãƒˆå¼·åŒ–**

   - ã‚«ãƒãƒ¬ãƒƒã‚¸85%å¿…é ˆåŒ–
   - ãƒŸãƒ¥ãƒ¼ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ãƒ†ã‚¹ãƒˆå°å…¥
   - ã‚³ãƒ¼ãƒ‰ã‚¯ã‚ªãƒªãƒ†ã‚£ãƒ¡ãƒˆãƒªã‚¯ã‚¹ç›£è¦–

3. **ç¶™ç¶šçš„å“è³ªæ”¹å–„**
   - æŠ€è¡“çš„è² å‚µã®å®šæœŸå‰Šæ¸›
   - ãƒ†ã‚¹ãƒˆãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹æ€§å‘ä¸Š
   - CI/CDå®Ÿè¡Œæ™‚é–“æœ€é©åŒ–

## âœ… æˆåŠŸåŸºæº–

### Phase 3å®Œäº†æ™‚

- [ ] unitãƒ†ã‚¹ãƒˆ: 80%ä»¥ä¸Šç¶­æŒ
- [ ] domainãƒ†ã‚¹ãƒˆ: 60%é”æˆ
- [ ] integrationãƒ†ã‚¹ãƒˆ: 40%é”æˆï¼ˆã¾ãŸã¯é©åˆ‡ãªã‚¹ã‚­ãƒƒãƒ—ï¼‰
- [ ] CI/CDãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³: å…¨ã‚¸ãƒ§ãƒ–æˆåŠŸ

### Phase 4å®Œäº†æ™‚

- [ ] unitãƒ†ã‚¹ãƒˆ: 85%é”æˆ
- [ ] domainãƒ†ã‚¹ãƒˆ: 70%é”æˆ
- [ ] integrationãƒ†ã‚¹ãƒˆ: 60%é”æˆ
- [ ] ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒ†ã‚¹ãƒˆ: å…¨åˆæ ¼

### Phase 6å®Œäº†æ™‚ï¼ˆMVPå®Œæˆï¼‰

- [ ] unitãƒ†ã‚¹ãƒˆ: 85%ä»¥ä¸Š
- [ ] domainãƒ†ã‚¹ãƒˆ: 80%ä»¥ä¸Š
- [ ] integrationãƒ†ã‚¹ãƒˆ: 75%ä»¥ä¸Š
- [ ] E2Eãƒ†ã‚¹ãƒˆ: ä¸»è¦ãƒ•ãƒ­ãƒ¼100%ã‚«ãƒãƒ¼
- [ ] ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚¹ã‚­ãƒ£ãƒ³: Critical/Highè„†å¼±æ€§ã‚¼ãƒ­

## ğŸ“ ãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹è¨ˆç”»

### é€±æ¬¡

- ã‚«ãƒãƒ¬ãƒƒã‚¸ãƒˆãƒ¬ãƒ³ãƒ‰ç›£è¦–
- å¤±æ•—ãƒ†ã‚¹ãƒˆã®å³åº§ä¿®æ­£
- æ–°è¦æ©Ÿèƒ½ã¸ã®ãƒ†ã‚¹ãƒˆè¿½åŠ 

### ã‚¹ãƒ—ãƒªãƒ³ãƒˆçµ‚äº†æ™‚

- ã‚«ãƒãƒ¬ãƒƒã‚¸ç›®æ¨™é”æˆç¢ºèª
- ãƒ†ã‚¹ãƒˆå“è³ªãƒ¬ãƒ“ãƒ¥ãƒ¼
- æŠ€è¡“çš„è² å‚µã®è©•ä¾¡

### Phaseå®Œäº†æ™‚

- ã‚«ãƒãƒ¬ãƒƒã‚¸ç›®æ¨™ã®å†è©•ä¾¡
- æ¬¡Phaseã®ç›®æ¨™è¨­å®š
- ãƒ†ã‚¹ãƒˆæˆ¦ç•¥ã®è¦‹ç›´ã—

## ğŸ”— é–¢é€£ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ

- [Backend CI/CD Pipeline](.github/workflows/backend-ci.yml)
- [pytestè¨­å®š](backend/pyproject.toml)
- [ãƒ†ã‚¹ãƒˆã‚¬ã‚¤ãƒ‰ãƒ©ã‚¤ãƒ³](docs/development/testing-guide.md)
- [Phaseåˆ¥å®Ÿè£…è¨ˆç”»](backend/CLAUDE.md)
