# AutoForgeNexus Cloudflare Workers Environment Variables
# edge-computing-specialist による 2025年最新設定テンプレート
# コピーして .env として使用し、実際の値を設定してください

# =============================================================================
# 基本設定
# =============================================================================

# 環境設定 (development/staging/production)
ENVIRONMENT=development
PROJECT_NAME=autoforgenexus
VERSION=1.0.0

# Cloudflare設定 (自動設定されます)
CLOUDFLARE_ACCOUNT_ID=your_account_id_here
CLOUDFLARE_API_TOKEN=your_api_token_here

# =============================================================================
# LLM プロバイダー設定
# =============================================================================

# OpenAI (必須)
OPENAI_API_KEY=sk-proj-your_openai_key_here
OPENAI_ORG_ID=org-your_org_id_here

# Anthropic Claude (必須)
ANTHROPIC_API_KEY=sk-ant-api03-your_anthropic_key_here

# Cohere (オプション)
COHERE_API_KEY=your_cohere_key_here

# Mistral (EU地域用、オプション)
MISTRAL_API_KEY=your_mistral_key_here

# LLM プロバイダー重み設定 (JSON形式)
# レイテンシ40%, コスト30%, 品質30%
LLM_PROVIDER_WEIGHTS={"latency": 0.4, "cost": 0.3, "quality": 0.3}

# =============================================================================
# 認証設定 (Clerk)
# =============================================================================

# Clerk Secret Key (必須)
CLERK_SECRET_KEY=sk_live_your_clerk_secret_key_here

# Clerk Publishable Key (フロントエンド用)
CLERK_PUBLISHABLE_KEY=pk_live_your_clerk_publishable_key_here

# JWT設定
JWT_SECRET=your_strong_jwt_secret_here_at_least_32_chars

# =============================================================================
# 観測性設定 (LangFuse)
# =============================================================================

# LangFuse設定 (LLMトレーシング)
LANGFUSE_PUBLIC_KEY=pk-lf-your_public_key_here
LANGFUSE_SECRET_KEY=sk-lf-your_secret_key_here
LANGFUSE_HOST=https://cloud.langfuse.com

# カスタムメトリクス設定
METRICS_ENABLED=true
TRACE_SAMPLING_RATE=0.1  # 10%サンプリング

# =============================================================================
# エッジコンピューティング設定
# =============================================================================

# エッジファーストプロンプト処理
EDGE_PROCESSING_ENABLED=true

# 階層化キャッシング戦略
CACHE_LAYERS=memory,kv,r2

# キャッシュTTL設定 (秒)
CACHE_TTL_MEMORY=300     # 5分
CACHE_TTL_KV=3600        # 1時間
CACHE_TTL_R2=86400       # 24時間

# パフォーマンス目標
MAX_LATENCY_P95=50       # P95レイテンシ目標 (ms)
MIN_CACHE_HIT_RATE=90    # キャッシュヒット率目標 (%)

# =============================================================================
# セキュリティ設定
# =============================================================================

# レート制限設定
RATE_LIMIT_RPM=1000      # リクエスト/分
RATE_LIMIT_BURST=100     # バースト許容数

# 地理的制限 (カンマ区切りの国コード)
BLOCKED_COUNTRIES=CN,RU,KP  # 例: 中国、ロシア、北朝鮮

# PII検出とマスキング
PII_DETECTION_ENABLED=true
PII_MASKING_ENABLED=true

# セキュリティヘッダー設定
CORS_ORIGINS=https://autoforgenexus.com,https://app.autoforgenexus.com
CSP_ENABLED=true
HSTS_ENABLED=true

# 暗号化設定
ENCRYPTION_KEY=your_32_character_encryption_key_here
HASH_SALT=your_unique_salt_for_hashing_here

# =============================================================================
# 開発・デバッグ設定
# =============================================================================

# ログレベル (DEBUG/INFO/WARNING/ERROR)
LOG_LEVEL=INFO

# デバッグモード
DEBUG=false

# 詳細ログ出力
VERBOSE_LOGGING=false

# パフォーマンス計測
PERFORMANCE_MONITORING=true

# =============================================================================
# 外部サービス設定
# =============================================================================

# Discord通知 (オプション)
DISCORD_WEBHOOK_URL=https://discord.com/api/webhooks/your_webhook_here

# Slack通知 (オプション)
SLACK_WEBHOOK_URL=https://hooks.slack.com/services/your_slack_webhook_here

# Sentry エラー監視 (オプション)
SENTRY_DSN=https://your_sentry_dsn_here

# =============================================================================
# データベース設定 (Workers 環境では自動設定)
# =============================================================================

# KV Namespace IDs (wranglerで自動設定)
KV_PROMPT_CACHE_ID=your_kv_namespace_id_here
KV_SESSION_CACHE_ID=your_kv_namespace_id_here
KV_USER_PREFERENCES_ID=your_kv_namespace_id_here
KV_SEMANTIC_CACHE_ID=your_kv_namespace_id_here

# R2 Bucket Names (wranglerで自動設定)
R2_PROMPT_STORAGE=autoforgenexus-prompts
R2_TEMPLATE_STORAGE=autoforgenexus-templates
R2_CACHE_STORAGE=autoforgenexus-cache

# D1 Database ID (wranglerで自動設定)
D1_ANALYTICS_DB_ID=your_d1_database_id_here

# =============================================================================
# 環境別オーバーライド設定
# =============================================================================

# Development環境用設定
DEV_CORS_ORIGINS=http://localhost:3000,http://localhost:8000
DEV_LOG_LEVEL=DEBUG
DEV_DEBUG=true
DEV_RATE_LIMIT_RPM=10000  # 開発時は制限緩和

# Staging環境用設定
STAGING_CORS_ORIGINS=https://staging.autoforgenexus.com
STAGING_LOG_LEVEL=INFO
STAGING_DEBUG=false

# Production環境用設定
PROD_CORS_ORIGINS=https://autoforgenexus.com
PROD_LOG_LEVEL=WARNING
PROD_DEBUG=false
PROD_RATE_LIMIT_RPM=1000

# =============================================================================
# 高度な設定 (上級者用)
# =============================================================================

# Workers実行制限
MAX_CPU_MS=30000         # CPU時間制限 (ms)
MAX_MEMORY_MB=128        # メモリ制限 (MB)
MAX_SUBREQUESTS=1000     # サブリクエスト制限

# エッジ処理タイムアウト
EDGE_TIMEOUT_MS=10000    # エッジ処理タイムアウト (ms)
LLM_TIMEOUT_MS=30000     # LLM API タイムアウト (ms)

# バッチ処理設定
BATCH_SIZE=100           # バッチ処理サイズ
PARALLEL_REQUESTS=10     # 並列リクエスト数

# キューイング設定
QUEUE_MAX_SIZE=1000      # キューサイズ上限
QUEUE_TIMEOUT_MS=5000    # キュータイムアウト

# =============================================================================
# 設定検証
# =============================================================================

# 設定検証を有効化 (開発時推奨)
VALIDATE_CONFIG=true

# 必須設定チェック
REQUIRE_ALL_KEYS=false

# 設定暗号化 (本番環境推奨)
ENCRYPT_SENSITIVE_CONFIG=false

# =============================================================================
# 注意事項
# =============================================================================
#
# 1. 本番環境では必ずすべての _your_*_here を実際の値に置き換えてください
# 2. API キーは絶対にコミットしないでください
# 3. 環境別に .env.development, .env.staging, .env.production を作成することを推奨
# 4. Cloudflare Workersの環境変数はwrangler secretsで管理することも可能です
# 5. セキュリティ関連の設定は本番環境では厳格にしてください
#
# セットアップガイド: ./scripts/setup-workers.sh を実行してください
# ドキュメント: ./README.md を参照してください
#
# =============================================================================